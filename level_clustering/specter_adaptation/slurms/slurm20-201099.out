/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[Script start] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
[GPU] GPU Available: True
[GPU] CUML Available: True
[GPU] Device 0: NVIDIA A30 (23.6GB)
[scan] Using 138 shard folders
[Before loading data] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
Counting rows:   0%|          | 0/138 [00:00<?, ?chunk/s]Counting rows:   1%|          | 1/138 [00:00<00:17,  7.87chunk/s]Counting rows:   1%|▏         | 2/138 [00:00<00:33,  4.09chunk/s]Counting rows:   3%|▎         | 4/138 [00:00<00:25,  5.27chunk/s]Counting rows:   5%|▌         | 7/138 [00:01<00:20,  6.34chunk/s]Counting rows:   7%|▋         | 10/138 [00:01<00:15,  8.45chunk/s]Counting rows:   9%|▊         | 12/138 [00:01<00:15,  8.01chunk/s]Counting rows:  11%|█         | 15/138 [00:01<00:13,  9.35chunk/s]Counting rows:  13%|█▎        | 18/138 [00:02<00:09, 12.02chunk/s]Counting rows:  14%|█▍        | 20/138 [00:02<00:11, 10.42chunk/s]Counting rows:  16%|█▌        | 22/138 [00:02<00:10, 10.90chunk/s]Counting rows:  17%|█▋        | 24/138 [00:02<00:13,  8.51chunk/s]Counting rows:  19%|█▉        | 26/138 [00:03<00:16,  6.90chunk/s]Counting rows:  20%|██        | 28/138 [00:03<00:13,  8.08chunk/s]Counting rows:  22%|██▏       | 30/138 [00:03<00:11,  9.01chunk/s]Counting rows:  23%|██▎       | 32/138 [00:03<00:11,  9.19chunk/s]Counting rows:  25%|██▍       | 34/138 [00:03<00:11,  9.17chunk/s]Counting rows:  26%|██▌       | 36/138 [00:04<00:10,  9.51chunk/s]Counting rows:  28%|██▊       | 38/138 [00:04<00:13,  7.45chunk/s]Counting rows:  28%|██▊       | 39/138 [00:04<00:14,  6.77chunk/s]Counting rows:  30%|███       | 42/138 [00:04<00:10,  9.14chunk/s]Counting rows:  32%|███▏      | 44/138 [00:05<00:12,  7.44chunk/s]Counting rows:  33%|███▎      | 46/138 [00:05<00:10,  8.77chunk/s]Counting rows:  36%|███▌      | 49/138 [00:05<00:07, 11.74chunk/s]Counting rows:  37%|███▋      | 51/138 [00:05<00:08, 10.06chunk/s]Counting rows:  38%|███▊      | 53/138 [00:06<00:09,  8.92chunk/s]Counting rows:  40%|███▉      | 55/138 [00:06<00:07, 10.56chunk/s]Counting rows:  41%|████▏     | 57/138 [00:06<00:08,  9.29chunk/s]Counting rows:  43%|████▎     | 59/138 [00:08<00:26,  3.00chunk/s]Counting rows:  43%|████▎     | 60/138 [00:08<00:27,  2.83chunk/s]Counting rows:  44%|████▍     | 61/138 [00:09<00:34,  2.25chunk/s]Counting rows:  46%|████▌     | 63/138 [00:09<00:23,  3.25chunk/s]Counting rows:  47%|████▋     | 65/138 [00:14<01:19,  1.09s/chunk]Counting rows:  48%|████▊     | 66/138 [00:15<01:08,  1.05chunk/s]Counting rows:  49%|████▉     | 68/138 [00:16<00:51,  1.36chunk/s]Counting rows:  51%|█████     | 70/138 [00:16<00:34,  1.98chunk/s]Counting rows:  51%|█████▏    | 71/138 [00:17<00:39,  1.70chunk/s]Counting rows:  53%|█████▎    | 73/138 [00:17<00:27,  2.34chunk/s]Counting rows:  54%|█████▎    | 74/138 [00:17<00:29,  2.16chunk/s]Counting rows:  54%|█████▍    | 75/138 [00:18<00:26,  2.34chunk/s]Counting rows:  55%|█████▌    | 76/138 [00:18<00:22,  2.78chunk/s]Counting rows:  57%|█████▋    | 78/138 [00:18<00:14,  4.19chunk/s]Counting rows:  58%|█████▊    | 80/138 [00:18<00:10,  5.71chunk/s]Counting rows:  59%|█████▉    | 82/138 [00:18<00:08,  6.36chunk/s]Counting rows:  62%|██████▏   | 85/138 [00:19<00:06,  8.52chunk/s]Counting rows:  63%|██████▎   | 87/138 [00:19<00:05,  9.35chunk/s]Counting rows:  64%|██████▍   | 89/138 [00:19<00:05,  8.99chunk/s]Counting rows:  67%|██████▋   | 92/138 [00:19<00:04, 11.13chunk/s]Counting rows:  69%|██████▉   | 95/138 [00:19<00:03, 13.74chunk/s]Counting rows:  72%|███████▏  | 99/138 [00:19<00:02, 17.97chunk/s]Counting rows:  74%|███████▍  | 102/138 [00:20<00:01, 18.23chunk/s]Counting rows:  76%|███████▌  | 105/138 [00:20<00:03,  8.67chunk/s]Counting rows:  78%|███████▊  | 107/138 [00:21<00:04,  7.37chunk/s]Counting rows:  79%|███████▉  | 109/138 [00:21<00:03,  8.04chunk/s]Counting rows:  80%|████████  | 111/138 [00:21<00:03,  8.83chunk/s]Counting rows:  82%|████████▏ | 113/138 [00:22<00:04,  6.02chunk/s]Counting rows:  83%|████████▎ | 115/138 [00:22<00:03,  7.22chunk/s]Counting rows:  85%|████████▍ | 117/138 [00:22<00:02,  8.35chunk/s]Counting rows:  86%|████████▌ | 119/138 [00:22<00:02,  8.87chunk/s]Counting rows:  88%|████████▊ | 121/138 [00:22<00:01, 10.19chunk/s]Counting rows:  89%|████████▉ | 123/138 [00:23<00:01,  8.96chunk/s]Counting rows:  91%|█████████ | 125/138 [00:23<00:01,  7.83chunk/s]Counting rows:  91%|█████████▏| 126/138 [00:23<00:01,  7.93chunk/s]Counting rows:  93%|█████████▎| 128/138 [00:23<00:01,  8.18chunk/s]Counting rows:  93%|█████████▎| 129/138 [00:24<00:01,  5.37chunk/s]Counting rows:  94%|█████████▍| 130/138 [00:24<00:01,  5.38chunk/s]Counting rows:  95%|█████████▍| 131/138 [00:24<00:01,  5.11chunk/s]Counting rows:  96%|█████████▌| 132/138 [00:24<00:01,  5.73chunk/s]Counting rows:  97%|█████████▋| 134/138 [00:24<00:00,  7.99chunk/s]Counting rows:  99%|█████████▊| 136/138 [00:25<00:00,  7.76chunk/s]Counting rows:  99%|█████████▉| 137/138 [00:25<00:00,  7.36chunk/s]Counting rows: 100%|██████████| 138/138 [00:25<00:00,  5.46chunk/s]
[load] Total paragraphs (after sampling): 1,375,099, dim=768
[load] Estimated memory for embeddings: 3.93GB
Loading shards:   0%|          | 0/138 [00:00<?, ?chunk/s]Loading shards:   1%|          | 1/138 [00:00<00:46,  2.97chunk/s]Loading shards:   1%|▏         | 2/138 [00:00<00:48,  2.78chunk/s]Loading shards:   2%|▏         | 3/138 [00:01<00:55,  2.42chunk/s]Loading shards:   3%|▎         | 4/138 [00:01<00:49,  2.71chunk/s]Loading shards:   4%|▎         | 5/138 [00:01<00:51,  2.57chunk/s]Loading shards:   4%|▍         | 6/138 [00:02<00:45,  2.87chunk/s]Loading shards:   5%|▌         | 7/138 [00:04<01:57,  1.12chunk/s]Loading shards:   6%|▌         | 8/138 [00:05<02:12,  1.02s/chunk]Loading shards:   7%|▋         | 9/138 [00:06<02:12,  1.02s/chunk]Loading shards:   7%|▋         | 10/138 [00:07<02:04,  1.03chunk/s]Loading shards:   8%|▊         | 11/138 [00:08<02:02,  1.04chunk/s]Loading shards:   9%|▊         | 12/138 [00:09<02:11,  1.04s/chunk]Loading shards:   9%|▉         | 13/138 [00:10<01:59,  1.05chunk/s]Loading shards:  10%|█         | 14/138 [00:11<01:57,  1.05chunk/s]Loading shards:  11%|█         | 15/138 [00:12<02:09,  1.05s/chunk]Loading shards:  12%|█▏        | 16/138 [00:13<02:09,  1.06s/chunk]Loading shards:  12%|█▏        | 17/138 [00:14<02:04,  1.03s/chunk]Loading shards:  13%|█▎        | 18/138 [00:15<01:58,  1.01chunk/s]Loading shards:  14%|█▍        | 19/138 [00:16<01:46,  1.12chunk/s]Loading shards:  14%|█▍        | 20/138 [00:17<01:54,  1.04chunk/s]Loading shards:  15%|█▌        | 21/138 [00:17<01:41,  1.16chunk/s]Loading shards:  16%|█▌        | 22/138 [00:18<01:38,  1.18chunk/s]Loading shards:  17%|█▋        | 23/138 [00:19<01:50,  1.04chunk/s]Loading shards:  17%|█▋        | 24/138 [00:20<01:32,  1.24chunk/s]Loading shards:  18%|█▊        | 25/138 [00:21<01:32,  1.22chunk/s]Loading shards:  19%|█▉        | 26/138 [00:21<01:29,  1.24chunk/s]Loading shards:  20%|█▉        | 27/138 [00:23<01:45,  1.06chunk/s]Loading shards:  20%|██        | 28/138 [00:25<02:12,  1.20s/chunk]Loading shards:  21%|██        | 29/138 [00:26<02:31,  1.39s/chunk]Loading shards:  22%|██▏       | 30/138 [00:27<02:09,  1.20s/chunk]Loading shards:  22%|██▏       | 31/138 [00:28<01:58,  1.10s/chunk]Loading shards:  23%|██▎       | 32/138 [00:29<01:56,  1.10s/chunk]Loading shards:  24%|██▍       | 33/138 [00:35<04:14,  2.42s/chunk]Loading shards:  25%|██▍       | 34/138 [00:38<04:35,  2.65s/chunk]Loading shards:  25%|██▌       | 35/138 [00:39<03:37,  2.11s/chunk]Loading shards:  26%|██▌       | 36/138 [00:42<04:07,  2.43s/chunk]Loading shards:  27%|██▋       | 37/138 [00:45<04:17,  2.55s/chunk]Loading shards:  28%|██▊       | 38/138 [00:45<03:21,  2.02s/chunk]Loading shards:  28%|██▊       | 39/138 [00:46<02:40,  1.63s/chunk]Loading shards:  29%|██▉       | 40/138 [00:48<02:43,  1.67s/chunk]Loading shards:  30%|██▉       | 41/138 [00:49<02:37,  1.62s/chunk]Loading shards:  30%|███       | 42/138 [00:52<03:07,  1.95s/chunk]Loading shards:  31%|███       | 43/138 [00:54<02:48,  1.78s/chunk]Loading shards:  32%|███▏      | 44/138 [00:55<02:37,  1.67s/chunk]Loading shards:  33%|███▎      | 45/138 [00:57<02:38,  1.70s/chunk]Loading shards:  33%|███▎      | 46/138 [00:58<02:34,  1.68s/chunk]Loading shards:  34%|███▍      | 47/138 [01:00<02:22,  1.57s/chunk]Loading shards:  35%|███▍      | 48/138 [01:01<02:14,  1.49s/chunk]Loading shards:  36%|███▌      | 49/138 [01:02<02:12,  1.49s/chunk]Loading shards:  36%|███▌      | 50/138 [01:04<02:16,  1.56s/chunk]Loading shards:  37%|███▋      | 51/138 [01:06<02:22,  1.64s/chunk]Loading shards:  38%|███▊      | 52/138 [01:07<02:16,  1.58s/chunk]Loading shards:  38%|███▊      | 53/138 [01:09<02:07,  1.50s/chunk]Loading shards:  39%|███▉      | 54/138 [01:10<01:58,  1.41s/chunk]Loading shards:  40%|███▉      | 55/138 [01:11<01:47,  1.29s/chunk]Loading shards:  41%|████      | 56/138 [01:12<01:40,  1.23s/chunk]Loading shards:  41%|████▏     | 57/138 [01:13<01:43,  1.28s/chunk]Loading shards:  42%|████▏     | 58/138 [01:15<01:42,  1.28s/chunk]Loading shards:  43%|████▎     | 59/138 [01:16<01:38,  1.24s/chunk]Loading shards:  43%|████▎     | 60/138 [01:17<01:33,  1.20s/chunk]Loading shards:  44%|████▍     | 61/138 [01:18<01:35,  1.24s/chunk]Loading shards:  45%|████▍     | 62/138 [01:20<01:41,  1.33s/chunk]Loading shards:  46%|████▌     | 63/138 [01:21<01:36,  1.28s/chunk]Loading shards:  46%|████▋     | 64/138 [01:22<01:29,  1.21s/chunk]Loading shards:  47%|████▋     | 65/138 [01:23<01:18,  1.08s/chunk]Loading shards:  48%|████▊     | 66/138 [01:25<01:34,  1.32s/chunk]Loading shards:  49%|████▊     | 67/138 [01:28<02:04,  1.75s/chunk]Loading shards:  49%|████▉     | 68/138 [01:29<01:51,  1.60s/chunk]Loading shards:  50%|█████     | 69/138 [01:30<01:34,  1.37s/chunk]Loading shards:  51%|█████     | 70/138 [01:31<01:27,  1.29s/chunk]Loading shards:  51%|█████▏    | 71/138 [01:32<01:20,  1.21s/chunk]Loading shards:  52%|█████▏    | 72/138 [01:33<01:18,  1.18s/chunk]Loading shards:  53%|█████▎    | 73/138 [01:34<01:15,  1.16s/chunk]Loading shards:  54%|█████▎    | 74/138 [01:35<01:04,  1.01s/chunk]Loading shards:  54%|█████▍    | 75/138 [01:48<05:00,  4.77s/chunk]Loading shards:  55%|█████▌    | 76/138 [01:49<03:43,  3.61s/chunk]Loading shards:  56%|█████▌    | 77/138 [01:50<02:56,  2.90s/chunk]Loading shards:  57%|█████▋    | 78/138 [01:51<02:17,  2.29s/chunk]Loading shards:  57%|█████▋    | 79/138 [01:52<01:44,  1.78s/chunk]Loading shards:  58%|█████▊    | 80/138 [01:53<01:39,  1.72s/chunk]Loading shards:  59%|█████▊    | 81/138 [01:54<01:18,  1.37s/chunk]Loading shards:  59%|█████▉    | 82/138 [01:55<01:13,  1.31s/chunk]Loading shards:  60%|██████    | 83/138 [01:56<01:14,  1.35s/chunk]Loading shards:  61%|██████    | 84/138 [01:59<01:30,  1.68s/chunk]Loading shards:  62%|██████▏   | 85/138 [02:01<01:41,  1.92s/chunk]Loading shards:  62%|██████▏   | 86/138 [02:02<01:24,  1.62s/chunk]Loading shards:  63%|██████▎   | 87/138 [02:03<01:12,  1.41s/chunk]Loading shards:  64%|██████▍   | 88/138 [02:04<01:02,  1.25s/chunk]Loading shards:  64%|██████▍   | 89/138 [02:05<00:54,  1.12s/chunk]Loading shards:  65%|██████▌   | 90/138 [02:06<00:50,  1.06s/chunk]Loading shards:  66%|██████▌   | 91/138 [02:07<00:45,  1.03chunk/s]Loading shards:  67%|██████▋   | 92/138 [02:08<00:47,  1.02s/chunk]Loading shards:  67%|██████▋   | 93/138 [02:09<00:47,  1.05s/chunk]Loading shards:  68%|██████▊   | 94/138 [02:10<00:46,  1.06s/chunk]Loading shards:  69%|██████▉   | 95/138 [02:11<00:42,  1.00chunk/s]Loading shards:  70%|██████▉   | 96/138 [02:12<00:43,  1.03s/chunk]Loading shards:  70%|███████   | 97/138 [02:14<00:51,  1.27s/chunk]Loading shards:  71%|███████   | 98/138 [02:15<00:48,  1.22s/chunk]Loading shards:  72%|███████▏  | 99/138 [02:16<00:42,  1.09s/chunk]Loading shards:  72%|███████▏  | 100/138 [02:17<00:40,  1.05s/chunk]Loading shards:  73%|███████▎  | 101/138 [02:18<00:38,  1.05s/chunk]Loading shards:  74%|███████▍  | 102/138 [02:18<00:34,  1.04chunk/s]Loading shards:  75%|███████▍  | 103/138 [02:19<00:32,  1.08chunk/s]Loading shards:  75%|███████▌  | 104/138 [02:20<00:29,  1.16chunk/s]Loading shards:  76%|███████▌  | 105/138 [02:21<00:30,  1.07chunk/s]Loading shards:  77%|███████▋  | 106/138 [02:22<00:26,  1.19chunk/s]Loading shards:  78%|███████▊  | 107/138 [02:23<00:25,  1.20chunk/s]Loading shards:  78%|███████▊  | 108/138 [02:23<00:22,  1.31chunk/s]Loading shards:  79%|███████▉  | 109/138 [02:24<00:21,  1.37chunk/s]Loading shards:  80%|███████▉  | 110/138 [02:24<00:20,  1.40chunk/s]Loading shards:  80%|████████  | 111/138 [02:26<00:22,  1.21chunk/s]Loading shards:  81%|████████  | 112/138 [02:26<00:21,  1.20chunk/s]Loading shards:  82%|████████▏ | 113/138 [02:27<00:21,  1.18chunk/s]Loading shards:  83%|████████▎ | 114/138 [02:28<00:20,  1.15chunk/s]Loading shards:  83%|████████▎ | 115/138 [02:29<00:20,  1.15chunk/s]Loading shards:  84%|████████▍ | 116/138 [02:30<00:18,  1.22chunk/s]Loading shards:  85%|████████▍ | 117/138 [02:30<00:16,  1.26chunk/s]Loading shards:  86%|████████▌ | 118/138 [02:31<00:15,  1.28chunk/s]Loading shards:  86%|████████▌ | 119/138 [02:32<00:15,  1.26chunk/s]Loading shards:  87%|████████▋ | 120/138 [02:33<00:13,  1.30chunk/s]Loading shards:  88%|████████▊ | 121/138 [02:34<00:12,  1.31chunk/s]Loading shards:  88%|████████▊ | 122/138 [02:34<00:12,  1.32chunk/s]Loading shards:  89%|████████▉ | 123/138 [02:35<00:11,  1.29chunk/s]Loading shards:  90%|████████▉ | 124/138 [02:36<00:10,  1.32chunk/s]Loading shards:  91%|█████████ | 125/138 [02:37<00:09,  1.33chunk/s]Loading shards:  91%|█████████▏| 126/138 [02:37<00:09,  1.27chunk/s]Loading shards:  92%|█████████▏| 127/138 [02:38<00:09,  1.20chunk/s]Loading shards:  93%|█████████▎| 128/138 [02:39<00:07,  1.35chunk/s]Loading shards:  93%|█████████▎| 129/138 [02:39<00:06,  1.44chunk/s]Loading shards:  94%|█████████▍| 130/138 [02:40<00:05,  1.38chunk/s]Loading shards:  95%|█████████▍| 131/138 [02:41<00:04,  1.47chunk/s]Loading shards:  96%|█████████▌| 132/138 [02:41<00:03,  1.53chunk/s]Loading shards:  96%|█████████▋| 133/138 [02:42<00:03,  1.60chunk/s]Loading shards:  97%|█████████▋| 134/138 [02:43<00:02,  1.67chunk/s]Loading shards:  98%|█████████▊| 135/138 [02:43<00:01,  1.64chunk/s]Loading shards:  99%|█████████▊| 136/138 [02:44<00:01,  1.65chunk/s]Loading shards:  99%|█████████▉| 137/138 [02:44<00:00,  1.66chunk/s]Loading shards: 100%|██████████| 138/138 [02:45<00:00,  1.91chunk/s]Loading shards: 100%|██████████| 138/138 [02:45<00:00,  1.20s/chunk]
/var/spool/slurm/d/job201099/slurm_script: line 26: 385178 Killed                  python cluster_chunks.py --chunks_root /vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/embeddings_v1_astrobert --work_dir ./cluster_out_v2_astrobert --backend umap_hdbscan --umap_dim 60 --n_neighbors 240 --min_cluster_size 12 --min_samples 2 --debug_memory
slurmstepd: error: Detected 1 oom_kill event in StepId=201099.batch. Some of the step tasks have been OOM Killed.
