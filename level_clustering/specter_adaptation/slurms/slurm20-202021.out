/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[Script start] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
[GPU] Forcing CPU usage
[scan] Using 138 shard folders
[Before consolidation] CPU: 0.60GB
[mmap] Counting total samples...
Counting:   0%|          | 0/138 [00:00<?, ?chunk/s]Counting:   9%|▉         | 13/138 [00:00<00:00, 128.46chunk/s]Counting:  20%|█▉        | 27/138 [00:00<00:00, 131.88chunk/s]Counting:  30%|██▉       | 41/138 [00:00<00:00, 132.26chunk/s]Counting:  40%|███▉      | 55/138 [00:00<00:00, 132.23chunk/s]Counting:  50%|█████     | 69/138 [00:00<00:00, 132.42chunk/s]Counting:  60%|██████    | 83/138 [00:00<00:00, 131.89chunk/s]Counting:  70%|███████   | 97/138 [00:00<00:00, 131.78chunk/s]Counting:  80%|████████  | 111/138 [00:00<00:00, 131.51chunk/s]Counting:  91%|█████████ | 125/138 [00:00<00:00, 132.46chunk/s]Counting: 100%|██████████| 138/138 [00:01<00:00, 132.28chunk/s]
[mmap] Total samples: 275,020, dimensions: 768
[mmap] Consolidating embeddings...
Consolidating:   0%|          | 0/138 [00:00<?, ?chunk/s]Consolidating:   1%|          | 1/138 [00:00<00:30,  4.44chunk/s]Consolidating:   1%|▏         | 2/138 [00:00<00:26,  5.06chunk/s]Consolidating:   2%|▏         | 3/138 [00:00<00:25,  5.30chunk/s]Consolidating:   3%|▎         | 4/138 [00:00<00:24,  5.44chunk/s]Consolidating:   4%|▎         | 5/138 [00:00<00:24,  5.49chunk/s]Consolidating:   4%|▍         | 6/138 [00:01<00:23,  5.52chunk/s]Consolidating:   5%|▌         | 7/138 [00:01<00:23,  5.55chunk/s]Consolidating:   6%|▌         | 8/138 [00:01<00:23,  5.58chunk/s]Consolidating:   7%|▋         | 9/138 [00:01<00:23,  5.60chunk/s]Consolidating:   7%|▋         | 10/138 [00:01<00:22,  5.60chunk/s]Consolidating:   8%|▊         | 11/138 [00:02<00:22,  5.61chunk/s]Consolidating:   9%|▊         | 12/138 [00:02<00:22,  5.60chunk/s]Consolidating:   9%|▉         | 13/138 [00:02<00:22,  5.59chunk/s]Consolidating:  10%|█         | 14/138 [00:02<00:22,  5.60chunk/s]Consolidating:  11%|█         | 15/138 [00:02<00:22,  5.58chunk/s]Consolidating:  12%|█▏        | 16/138 [00:02<00:21,  5.59chunk/s]Consolidating:  12%|█▏        | 17/138 [00:03<00:21,  5.58chunk/s]Consolidating:  13%|█▎        | 18/138 [00:03<00:21,  5.60chunk/s]Consolidating:  14%|█▍        | 19/138 [00:03<00:21,  5.59chunk/s]Consolidating:  14%|█▍        | 20/138 [00:03<00:21,  5.59chunk/s]Consolidating:  15%|█▌        | 21/138 [00:03<00:20,  5.60chunk/s]Consolidating:  16%|█▌        | 22/138 [00:03<00:20,  5.60chunk/s]Consolidating:  17%|█▋        | 23/138 [00:04<00:20,  5.59chunk/s]Consolidating:  17%|█▋        | 24/138 [00:04<00:20,  5.59chunk/s]Consolidating:  18%|█▊        | 25/138 [00:04<00:20,  5.57chunk/s]Consolidating:  19%|█▉        | 26/138 [00:04<00:20,  5.57chunk/s]Consolidating:  20%|█▉        | 27/138 [00:04<00:19,  5.55chunk/s]Consolidating:  20%|██        | 28/138 [00:05<00:19,  5.55chunk/s]Consolidating:  21%|██        | 29/138 [00:05<00:19,  5.56chunk/s]Consolidating:  22%|██▏       | 30/138 [00:05<00:19,  5.56chunk/s]Consolidating:  22%|██▏       | 31/138 [00:05<00:19,  5.55chunk/s]Consolidating:  23%|██▎       | 32/138 [00:05<00:19,  5.55chunk/s]Consolidating:  24%|██▍       | 33/138 [00:05<00:19,  5.52chunk/s]Consolidating:  25%|██▍       | 34/138 [00:06<00:18,  5.52chunk/s]Consolidating:  25%|██▌       | 35/138 [00:06<00:18,  5.51chunk/s]Consolidating:  26%|██▌       | 36/138 [00:06<00:18,  5.51chunk/s]Consolidating:  27%|██▋       | 37/138 [00:06<00:18,  5.52chunk/s]Consolidating:  28%|██▊       | 38/138 [00:06<00:18,  5.54chunk/s]Consolidating:  28%|██▊       | 39/138 [00:07<00:17,  5.54chunk/s]Consolidating:  29%|██▉       | 40/138 [00:07<00:17,  5.54chunk/s]Consolidating:  30%|██▉       | 41/138 [00:07<00:17,  5.55chunk/s]Consolidating:  30%|███       | 42/138 [00:07<00:17,  5.56chunk/s]Consolidating:  31%|███       | 43/138 [00:07<00:17,  5.57chunk/s]Consolidating:  32%|███▏      | 44/138 [00:07<00:16,  5.56chunk/s]Consolidating:  33%|███▎      | 45/138 [00:08<00:16,  5.53chunk/s]Consolidating:  33%|███▎      | 46/138 [00:08<00:16,  5.51chunk/s]Consolidating:  34%|███▍      | 47/138 [00:08<00:16,  5.50chunk/s]Consolidating:  35%|███▍      | 48/138 [00:08<00:16,  5.50chunk/s]Consolidating:  36%|███▌      | 49/138 [00:08<00:16,  5.51chunk/s]Consolidating:  36%|███▌      | 50/138 [00:09<00:16,  5.49chunk/s]Consolidating:  37%|███▋      | 51/138 [00:09<00:15,  5.48chunk/s]Consolidating:  38%|███▊      | 52/138 [00:09<00:15,  5.45chunk/s]Consolidating:  38%|███▊      | 53/138 [00:09<00:15,  5.45chunk/s]Consolidating:  39%|███▉      | 54/138 [00:09<00:15,  5.46chunk/s]Consolidating:  40%|███▉      | 55/138 [00:09<00:15,  5.46chunk/s]Consolidating:  41%|████      | 56/138 [00:10<00:15,  5.45chunk/s]Consolidating:  41%|████▏     | 57/138 [00:10<00:14,  5.44chunk/s]Consolidating:  42%|████▏     | 58/138 [00:10<00:14,  5.45chunk/s]Consolidating:  43%|████▎     | 59/138 [00:10<00:14,  5.46chunk/s]Consolidating:  43%|████▎     | 60/138 [00:10<00:14,  5.46chunk/s]Consolidating:  44%|████▍     | 61/138 [00:11<00:14,  5.46chunk/s]Consolidating:  45%|████▍     | 62/138 [00:11<00:13,  5.48chunk/s]Consolidating:  46%|████▌     | 63/138 [00:11<00:13,  5.48chunk/s]Consolidating:  46%|████▋     | 64/138 [00:11<00:13,  5.47chunk/s]Consolidating:  47%|████▋     | 65/138 [00:11<00:13,  5.45chunk/s]Consolidating:  48%|████▊     | 66/138 [00:11<00:13,  5.46chunk/s]Consolidating:  49%|████▊     | 67/138 [00:12<00:12,  5.46chunk/s]Consolidating:  49%|████▉     | 68/138 [00:12<00:12,  5.46chunk/s]Consolidating:  50%|█████     | 69/138 [00:12<00:12,  5.46chunk/s]Consolidating:  51%|█████     | 70/138 [00:12<00:12,  5.47chunk/s]Consolidating:  51%|█████▏    | 71/138 [00:12<00:12,  5.46chunk/s]Consolidating:  52%|█████▏    | 72/138 [00:13<00:12,  5.46chunk/s]Consolidating:  53%|█████▎    | 73/138 [00:13<00:11,  5.44chunk/s]Consolidating:  54%|█████▎    | 74/138 [00:13<00:11,  5.44chunk/s]Consolidating:  54%|█████▍    | 75/138 [00:13<00:11,  5.35chunk/s]Consolidating:  55%|█████▌    | 76/138 [00:13<00:11,  5.38chunk/s]Consolidating:  56%|█████▌    | 77/138 [00:13<00:11,  5.40chunk/s]Consolidating:  57%|█████▋    | 78/138 [00:14<00:11,  5.40chunk/s]Consolidating:  57%|█████▋    | 79/138 [00:14<00:10,  5.39chunk/s]Consolidating:  58%|█████▊    | 80/138 [00:14<00:10,  5.38chunk/s]Consolidating:  59%|█████▊    | 81/138 [00:14<00:10,  5.38chunk/s]Consolidating:  59%|█████▉    | 82/138 [00:14<00:10,  5.37chunk/s]Consolidating:  60%|██████    | 83/138 [00:15<00:10,  5.39chunk/s]Consolidating:  61%|██████    | 84/138 [00:15<00:10,  5.38chunk/s]Consolidating:  62%|██████▏   | 85/138 [00:15<00:09,  5.39chunk/s]Consolidating:  62%|██████▏   | 86/138 [00:15<00:09,  5.39chunk/s]Consolidating:  63%|██████▎   | 87/138 [00:15<00:09,  5.41chunk/s]Consolidating:  64%|██████▍   | 88/138 [00:16<00:09,  5.42chunk/s]Consolidating:  64%|██████▍   | 89/138 [00:16<00:09,  5.40chunk/s]Consolidating:  65%|██████▌   | 90/138 [00:16<00:08,  5.41chunk/s]Consolidating:  66%|██████▌   | 91/138 [00:16<00:08,  5.40chunk/s]Consolidating:  67%|██████▋   | 92/138 [00:16<00:08,  5.40chunk/s]Consolidating:  67%|██████▋   | 93/138 [00:16<00:08,  5.41chunk/s]Consolidating:  68%|██████▊   | 94/138 [00:17<00:08,  5.41chunk/s]Consolidating:  69%|██████▉   | 95/138 [00:17<00:07,  5.40chunk/s]Consolidating:  70%|██████▉   | 96/138 [00:17<00:07,  5.41chunk/s]Consolidating:  70%|███████   | 97/138 [00:17<00:07,  5.41chunk/s]Consolidating:  71%|███████   | 98/138 [00:17<00:07,  5.41chunk/s]Consolidating:  72%|███████▏  | 99/138 [00:18<00:07,  5.39chunk/s]Consolidating:  72%|███████▏  | 100/138 [00:18<00:07,  5.37chunk/s]Consolidating:  73%|███████▎  | 101/138 [00:18<00:06,  5.37chunk/s]Consolidating:  74%|███████▍  | 102/138 [00:18<00:06,  5.36chunk/s]Consolidating:  75%|███████▍  | 103/138 [00:18<00:06,  5.37chunk/s]Consolidating:  75%|███████▌  | 104/138 [00:19<00:06,  5.36chunk/s]Consolidating:  76%|███████▌  | 105/138 [00:19<00:06,  5.37chunk/s]Consolidating:  77%|███████▋  | 106/138 [00:19<00:05,  5.38chunk/s]Consolidating:  78%|███████▊  | 107/138 [00:19<00:05,  5.38chunk/s]Consolidating:  78%|███████▊  | 108/138 [00:19<00:05,  5.37chunk/s]Consolidating:  79%|███████▉  | 109/138 [00:19<00:05,  5.36chunk/s]Consolidating:  80%|███████▉  | 110/138 [00:20<00:05,  5.33chunk/s]Consolidating:  80%|████████  | 111/138 [00:20<00:05,  5.34chunk/s]Consolidating:  81%|████████  | 112/138 [00:20<00:04,  5.33chunk/s]Consolidating:  82%|████████▏ | 113/138 [00:20<00:04,  5.22chunk/s]Consolidating:  83%|████████▎ | 114/138 [00:20<00:04,  5.04chunk/s]Consolidating:  83%|████████▎ | 115/138 [00:21<00:04,  5.14chunk/s]Consolidating:  84%|████████▍ | 116/138 [00:21<00:04,  5.20chunk/s]Consolidating:  85%|████████▍ | 117/138 [00:21<00:04,  5.21chunk/s]Consolidating:  86%|████████▌ | 118/138 [00:21<00:03,  5.25chunk/s]Consolidating:  86%|████████▌ | 119/138 [00:21<00:03,  5.27chunk/s]Consolidating:  87%|████████▋ | 120/138 [00:22<00:03,  5.28chunk/s]Consolidating:  88%|████████▊ | 121/138 [00:22<00:03,  5.29chunk/s]Consolidating:  88%|████████▊ | 122/138 [00:22<00:03,  5.30chunk/s]Consolidating:  89%|████████▉ | 123/138 [00:22<00:02,  5.29chunk/s]Consolidating:  90%|████████▉ | 124/138 [00:22<00:02,  5.27chunk/s]Consolidating:  91%|█████████ | 125/138 [00:22<00:02,  5.28chunk/s]Consolidating:  91%|█████████▏| 126/138 [00:23<00:02,  5.27chunk/s]Consolidating:  92%|█████████▏| 127/138 [00:23<00:02,  5.29chunk/s]Consolidating:  93%|█████████▎| 128/138 [00:23<00:01,  5.30chunk/s]Consolidating:  93%|█████████▎| 129/138 [00:23<00:01,  5.30chunk/s]Consolidating:  94%|█████████▍| 130/138 [00:23<00:01,  5.30chunk/s]Consolidating:  95%|█████████▍| 131/138 [00:24<00:01,  5.27chunk/s]Consolidating:  96%|█████████▌| 132/138 [00:24<00:01,  5.26chunk/s]Consolidating:  96%|█████████▋| 133/138 [00:24<00:00,  5.27chunk/s]Consolidating:  97%|█████████▋| 134/138 [00:24<00:00,  5.28chunk/s]Consolidating:  98%|█████████▊| 135/138 [00:24<00:00,  5.28chunk/s]Consolidating:  99%|█████████▊| 136/138 [00:25<00:00,  5.28chunk/s]Consolidating:  99%|█████████▉| 137/138 [00:25<00:00,  5.27chunk/s]Consolidating: 100%|██████████| 138/138 [00:25<00:00,  5.60chunk/s]Consolidating: 100%|██████████| 138/138 [00:25<00:00,  5.43chunk/s]
[After consolidation] CPU: 1.44GB
[mmap] Consolidated 275,020 embeddings to cluster_out_v5_astrobert/consolidated_embeddings.dat
[mmap] Loaded embeddings shape: (275020, 768)
[umap] dim=50 n_neighbors=50
CUML not available, falling back to CPU UMAP
[Before CPU UMAP] CPU: 0.65GB
[CPU-UMAP] Attempting to load 275,020 points into memory
UMAP(angular_rp_forest=True, metric='cosine', min_dist=0.05, n_components=50, n_neighbors=50, random_state=42, verbose=True)
Sun Sep  7 15:17:05 2025 Construct fuzzy simplicial set
Sun Sep  7 15:17:05 2025 Finding Nearest Neighbors
Sun Sep  7 15:17:05 2025 Building RP forest with 31 trees
Sun Sep  7 15:17:21 2025 NN descent for 18 iterations
	 1  /  18
	 2  /  18
	 3  /  18
	Stopping threshold met -- exiting after 3 iterations
Sun Sep  7 15:18:29 2025 Finished Nearest Neighbor Search
Sun Sep  7 15:18:35 2025 Construct embedding
Epochs completed:   0%|            0/200 [00:00]Epochs completed:   0%|            1/200 [00:00]Epochs completed:   1%|            2/200 [00:01]Epochs completed:   2%| ▏          3/200 [00:02]Epochs completed:   2%| ▏          4/200 [00:04]Epochs completed:   2%| ▎          5/200 [00:07]Epochs completed:   3%| ▎          6/200 [00:09]Epochs completed:   4%| ▎          7/200 [00:12]Epochs completed:   4%| ▍          8/200 [00:15]Epochs completed:   4%| ▍          9/200 [00:18]Epochs completed:   5%| ▌          10/200 [00:21]Epochs completed:   6%| ▌          11/200 [00:24]Epochs completed:   6%| ▌          12/200 [00:27]Epochs completed:   6%| ▋          13/200 [00:31]Epochs completed:   7%| ▋          14/200 [00:34]Epochs completed:   8%| ▊          15/200 [00:38]Epochs completed:   8%| ▊          16/200 [00:41]Epochs completed:   8%| ▊          17/200 [00:45]Epochs completed:   9%| ▉          18/200 [00:48]Epochs completed:  10%| ▉          19/200 [00:52]Epochs completed:  10%| █          20/200 [00:55]Epochs completed:  10%| █          21/200 [00:59]Epochs completed:  11%| █          22/200 [01:02]Epochs completed:  12%| █▏         23/200 [01:06]Epochs completed:  12%| █▏         24/200 [01:10]Epochs completed:  12%| █▎         25/200 [01:13]Epochs completed:  13%| █▎         26/200 [01:17]Epochs completed:  14%| █▎         27/200 [01:21]Epochs completed:  14%| █▍         28/200 [01:24]Epochs completed:  14%| █▍         29/200 [01:28]Epochs completed:  15%| █▌         30/200 [01:32]Epochs completed:  16%| █▌         31/200 [01:35]Epochs completed:  16%| █▌         32/200 [01:39]Epochs completed:  16%| █▋         33/200 [01:43]Epochs completed:  17%| █▋         34/200 [01:46]Epochs completed:  18%| █▊         35/200 [01:50]Epochs completed:  18%| █▊         36/200 [01:54]Epochs completed:  18%| █▊         37/200 [01:57]Epochs completed:  19%| █▉         38/200 [02:01]Epochs completed:  20%| █▉         39/200 [02:05]Epochs completed:  20%| ██         40/200 [02:08]Epochs completed:  20%| ██         41/200 [02:12]Epochs completed:  21%| ██         42/200 [02:16]Epochs completed:  22%| ██▏        43/200 [02:20]Epochs completed:  22%| ██▏        44/200 [02:23]Epochs completed:  22%| ██▎        45/200 [02:27]Epochs completed:  23%| ██▎        46/200 [02:31]Epochs completed:  24%| ██▎        47/200 [02:35]Epochs completed:  24%| ██▍        48/200 [02:38]Epochs completed:  24%| ██▍        49/200 [02:42]Epochs completed:  25%| ██▌        50/200 [02:46]Epochs completed:  26%| ██▌        51/200 [02:50]Epochs completed:  26%| ██▌        52/200 [02:53]Epochs completed:  26%| ██▋        53/200 [02:57]Epochs completed:  27%| ██▋        54/200 [03:01]Epochs completed:  28%| ██▊        55/200 [03:04]Epochs completed:  28%| ██▊        56/200 [03:08]Epochs completed:  28%| ██▊        57/200 [03:12]Epochs completed:  29%| ██▉        58/200 [03:16]Epochs completed:  30%| ██▉        59/200 [03:19]Epochs completed:  30%| ███        60/200 [03:23]Epochs completed:  30%| ███        61/200 [03:27]Epochs completed:  31%| ███        62/200 [03:31]Epochs completed:  32%| ███▏       63/200 [03:34]Epochs completed:  32%| ███▏       64/200 [03:38]Epochs completed:  32%| ███▎       65/200 [03:42]Epochs completed:  33%| ███▎       66/200 [03:46]Epochs completed:  34%| ███▎       67/200 [03:49]Epochs completed:  34%| ███▍       68/200 [03:53]Epochs completed:  34%| ███▍       69/200 [03:57]Epochs completed:  35%| ███▌       70/200 [04:00]Epochs completed:  36%| ███▌       71/200 [04:04]Epochs completed:  36%| ███▌       72/200 [04:08]Epochs completed:  36%| ███▋       73/200 [04:12]Epochs completed:  37%| ███▋       74/200 [04:15]Epochs completed:  38%| ███▊       75/200 [04:19]Epochs completed:  38%| ███▊       76/200 [04:23]Epochs completed:  38%| ███▊       77/200 [04:27]Epochs completed:  39%| ███▉       78/200 [04:30]Epochs completed:  40%| ███▉       79/200 [04:34]Epochs completed:  40%| ████       80/200 [04:38]Epochs completed:  40%| ████       81/200 [04:42]Epochs completed:  41%| ████       82/200 [04:45]Epochs completed:  42%| ████▏      83/200 [04:49]Epochs completed:  42%| ████▏      84/200 [04:53]Epochs completed:  42%| ████▎      85/200 [04:57]Epochs completed:  43%| ████▎      86/200 [05:00]Epochs completed:  44%| ████▎      87/200 [05:04]Epochs completed:  44%| ████▍      88/200 [05:08]Epochs completed:  44%| ████▍      89/200 [05:12]Epochs completed:  45%| ████▌      90/200 [05:15]Epochs completed:  46%| ████▌      91/200 [05:19]Epochs completed:  46%| ████▌      92/200 [05:23]Epochs completed:  46%| ████▋      93/200 [05:27]Epochs completed:  47%| ████▋      94/200 [05:30]Epochs completed:  48%| ████▊      95/200 [05:34]Epochs completed:  48%| ████▊      96/200 [05:38]Epochs completed:  48%| ████▊      97/200 [05:42]Epochs completed:  49%| ████▉      98/200 [05:45]Epochs completed:  50%| ████▉      99/200 [05:49]Epochs completed:  50%| █████      100/200 [05:53]Epochs completed:  50%| █████      101/200 [05:57]Epochs completed:  51%| █████      102/200 [06:00]Epochs completed:  52%| █████▏     103/200 [06:04]Epochs completed:  52%| █████▏     104/200 [06:08]Epochs completed:  52%| █████▎     105/200 [06:11]Epochs completed:  53%| █████▎     106/200 [06:15]Epochs completed:  54%| █████▎     107/200 [06:19]Epochs completed:  54%| █████▍     108/200 [06:23]Epochs completed:  55%| █████▍     109/200 [06:26]Epochs completed:  55%| █████▌     110/200 [06:30]Epochs completed:  56%| █████▌     111/200 [06:34]Epochs completed:  56%| █████▌     112/200 [06:38]Epochs completed:  56%| █████▋     113/200 [06:41]Epochs completed:  57%| █████▋     114/200 [06:45]Epochs completed:  57%| █████▊     115/200 [06:49]Epochs completed:  58%| █████▊     116/200 [06:52]Epochs completed:  58%| █████▊     117/200 [06:56]Epochs completed:  59%| █████▉     118/200 [07:00]Epochs completed:  60%| █████▉     119/200 [07:04]Epochs completed:  60%| ██████     120/200 [07:07]Epochs completed:  60%| ██████     121/200 [07:11]Epochs completed:  61%| ██████     122/200 [07:15]Epochs completed:  62%| ██████▏    123/200 [07:18]Epochs completed:  62%| ██████▏    124/200 [07:22]Epochs completed:  62%| ██████▎    125/200 [07:26]Epochs completed:  63%| ██████▎    126/200 [07:30]Epochs completed:  64%| ██████▎    127/200 [07:33]Epochs completed:  64%| ██████▍    128/200 [07:37]Epochs completed:  64%| ██████▍    129/200 [07:41]Epochs completed:  65%| ██████▌    130/200 [07:45]Epochs completed:  66%| ██████▌    131/200 [07:48]Epochs completed:  66%| ██████▌    132/200 [07:52]Epochs completed:  66%| ██████▋    133/200 [07:56]Epochs completed:  67%| ██████▋    134/200 [07:59]Epochs completed:  68%| ██████▊    135/200 [08:03]Epochs completed:  68%| ██████▊    136/200 [08:07]Epochs completed:  68%| ██████▊    137/200 [08:11]Epochs completed:  69%| ██████▉    138/200 [08:14]Epochs completed:  70%| ██████▉    139/200 [08:18]Epochs completed:  70%| ███████    140/200 [08:22]Epochs completed:  70%| ███████    141/200 [08:26]Epochs completed:  71%| ███████    142/200 [08:29]Epochs completed:  72%| ███████▏   143/200 [08:33]Epochs completed:  72%| ███████▏   144/200 [08:37]Epochs completed:  72%| ███████▎   145/200 [08:40]Epochs completed:  73%| ███████▎   146/200 [08:44]Epochs completed:  74%| ███████▎   147/200 [08:48]Epochs completed:  74%| ███████▍   148/200 [08:52]Epochs completed:  74%| ███████▍   149/200 [08:55]Epochs completed:  75%| ███████▌   150/200 [08:59]Epochs completed:  76%| ███████▌   151/200 [09:03]Epochs completed:  76%| ███████▌   152/200 [09:06]Epochs completed:  76%| ███████▋   153/200 [09:10]Epochs completed:  77%| ███████▋   154/200 [09:14]Epochs completed:  78%| ███████▊   155/200 [09:18]Epochs completed:  78%| ███████▊   156/200 [09:22]Epochs completed:  78%| ███████▊   157/200 [09:25]Epochs completed:  79%| ███████▉   158/200 [09:29]Epochs completed:  80%| ███████▉   159/200 [09:33]Epochs completed:  80%| ████████   160/200 [09:37]Epochs completed:  80%| ████████   161/200 [09:41]Epochs completed:  81%| ████████   162/200 [09:44]Epochs completed:  82%| ████████▏  163/200 [09:48]Epochs completed:  82%| ████████▏  164/200 [09:52]Epochs completed:  82%| ████████▎  165/200 [09:56]Epochs completed:  83%| ████████▎  166/200 [09:59]Epochs completed:  84%| ████████▎  167/200 [10:03]Epochs completed:  84%| ████████▍  168/200 [10:07]Epochs completed:  84%| ████████▍  169/200 [10:11]Epochs completed:  85%| ████████▌  170/200 [10:14]Epochs completed:  86%| ████████▌  171/200 [10:18]Epochs completed:  86%| ████████▌  172/200 [10:22]Epochs completed:  86%| ████████▋  173/200 [10:26]Epochs completed:  87%| ████████▋  174/200 [10:29]Epochs completed:  88%| ████████▊  175/200 [10:33]Epochs completed:  88%| ████████▊  176/200 [10:37]Epochs completed:  88%| ████████▊  177/200 [10:41]Epochs completed:  89%| ████████▉  178/200 [10:45]Epochs completed:  90%| ████████▉  179/200 [10:49]Epochs completed:  90%| █████████  180/200 [10:52]Epochs completed:  90%| █████████  181/200 [10:56]Epochs completed:  91%| █████████  182/200 [11:00]Epochs completed:  92%| █████████▏ 183/200 [11:04]Epochs completed:  92%| █████████▏ 184/200 [11:07]Epochs completed:  92%| █████████▎ 185/200 [11:11]Epochs completed:  93%| █████████▎ 186/200 [11:15]Epochs completed:  94%| █████████▎ 187/200 [11:18]Epochs completed:  94%| █████████▍ 188/200 [11:22]Epochs completed:  94%| █████████▍ 189/200 [11:26]Epochs completed:  95%| █████████▌ 190/200 [11:30]Epochs completed:  96%| █████████▌ 191/200 [11:33]Epochs completed:  96%| █████████▌ 192/200 [11:37]Epochs completed:  96%| █████████▋ 193/200 [11:41]Epochs completed:  97%| █████████▋ 194/200 [11:45]Epochs completed:  98%| █████████▊ 195/200 [11:48]Epochs completed:  98%| █████████▊ 196/200 [11:52]Epochs completed:  98%| █████████▊ 197/200 [11:56]Epochs completed:  99%| █████████▉ 198/200 [11:59]Epochs completed: 100%| █████████▉ 199/200 [12:03]Epochs completed: 100%| ██████████ 200/200 [12:07]Epochs completed: 100%| ██████████ 200/200 [12:07]
Sun Sep  7 15:32:45 2025 Finished embedding
[After CPU UMAP] CPU: 4.72GB
[hdbscan] metric=euclidean min_cluster_size=500
CUML not available, falling back to CPU HDBSCAN
[Before CPU HDBSCAN] CPU: 1.97GB
[CPU-HDBSCAN] Clustering 275,020 points with metric=euclidean
[After CPU HDBSCAN] CPU: 2.00GB

============================================================
CLUSTERING RESULTS
============================================================
{
  "paragraphs": 275020,
  "clusters": 50,
  "noise": 152474,
  "noise_pct": 55.44,
  "avg_cluster_size": 2450.92,
  "median_cluster_size": 1394,
  "min_cluster_size": 530,
  "max_cluster_size": 17456
}
============================================================

[write] Labels saved to: cluster_out_v5_astrobert/labels_paragraph.csv
[write] Summary saved to: cluster_out_v5_astrobert/cluster_summary.json
[write] Config saved to: cluster_out_v5_astrobert/cluster_config.json
[Script end] CPU: 2.00GB

✓ Memory-optimized clustering completed successfully!
