/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[Script start] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
[GPU] Forcing CPU usage
[scan] Using 138 shard folders
[Before consolidation] CPU: 0.60GB
[mmap] Counting total samples...
Counting:   0%|          | 0/138 [00:00<?, ?chunk/s]Counting:   7%|▋         | 10/138 [00:00<00:01, 99.63chunk/s]Counting:  17%|█▋        | 24/138 [00:00<00:00, 122.48chunk/s]Counting:  28%|██▊       | 39/138 [00:00<00:00, 130.78chunk/s]Counting:  38%|███▊      | 53/138 [00:00<00:00, 132.60chunk/s]Counting:  49%|████▊     | 67/138 [00:00<00:00, 133.05chunk/s]Counting:  59%|█████▊    | 81/138 [00:00<00:00, 134.36chunk/s]Counting:  69%|██████▉   | 95/138 [00:00<00:00, 131.83chunk/s]Counting:  79%|███████▉  | 109/138 [00:00<00:00, 132.27chunk/s]Counting:  89%|████████▉ | 123/138 [00:00<00:00, 132.09chunk/s]Counting:  99%|█████████▉| 137/138 [00:01<00:00, 132.44chunk/s]Counting: 100%|██████████| 138/138 [00:01<00:00, 130.99chunk/s]
[mmap] Total samples: 1,375,099, dimensions: 768
[mmap] Consolidating embeddings...
Consolidating:   0%|          | 0/138 [00:00<?, ?chunk/s]Consolidating:   1%|          | 1/138 [00:00<00:54,  2.50chunk/s]Consolidating:   1%|▏         | 2/138 [00:00<00:50,  2.69chunk/s]Consolidating:   2%|▏         | 3/138 [00:01<00:48,  2.76chunk/s]Consolidating:   3%|▎         | 4/138 [00:01<00:47,  2.80chunk/s]Consolidating:   4%|▎         | 5/138 [00:01<00:47,  2.83chunk/s]Consolidating:   4%|▍         | 6/138 [00:02<00:46,  2.83chunk/s]Consolidating:   5%|▌         | 7/138 [00:02<00:46,  2.81chunk/s]Consolidating:   6%|▌         | 8/138 [00:02<00:45,  2.83chunk/s]Consolidating:   7%|▋         | 9/138 [00:03<00:45,  2.84chunk/s]Consolidating:   7%|▋         | 10/138 [00:03<00:45,  2.84chunk/s]Consolidating:   8%|▊         | 11/138 [00:03<00:44,  2.83chunk/s]Consolidating:   9%|▊         | 12/138 [00:04<00:44,  2.84chunk/s]Consolidating:   9%|▉         | 13/138 [00:04<00:44,  2.83chunk/s]Consolidating:  10%|█         | 14/138 [00:04<00:43,  2.85chunk/s]Consolidating:  11%|█         | 15/138 [00:05<00:43,  2.86chunk/s]Consolidating:  12%|█▏        | 16/138 [00:05<00:42,  2.85chunk/s]Consolidating:  12%|█▏        | 17/138 [00:06<00:42,  2.84chunk/s]Consolidating:  13%|█▎        | 18/138 [00:06<00:42,  2.84chunk/s]Consolidating:  14%|█▍        | 19/138 [00:06<00:42,  2.82chunk/s]Consolidating:  14%|█▍        | 20/138 [00:07<00:41,  2.82chunk/s]Consolidating:  15%|█▌        | 21/138 [00:07<00:41,  2.82chunk/s]Consolidating:  16%|█▌        | 22/138 [00:07<00:41,  2.83chunk/s]Consolidating:  17%|█▋        | 23/138 [00:08<00:40,  2.83chunk/s]Consolidating:  17%|█▋        | 24/138 [00:08<00:40,  2.83chunk/s]Consolidating:  18%|█▊        | 25/138 [00:08<00:39,  2.83chunk/s]Consolidating:  19%|█▉        | 26/138 [00:09<00:39,  2.83chunk/s]Consolidating:  20%|█▉        | 27/138 [00:09<00:44,  2.48chunk/s]Consolidating:  20%|██        | 28/138 [00:10<00:42,  2.57chunk/s]Consolidating:  21%|██        | 29/138 [00:10<00:41,  2.64chunk/s]Consolidating:  22%|██▏       | 30/138 [00:10<00:40,  2.69chunk/s]Consolidating:  22%|██▏       | 31/138 [00:11<00:39,  2.73chunk/s]Consolidating:  23%|██▎       | 32/138 [00:11<00:38,  2.76chunk/s]Consolidating:  24%|██▍       | 33/138 [00:11<00:37,  2.78chunk/s]Consolidating:  25%|██▍       | 34/138 [00:12<00:37,  2.79chunk/s]Consolidating:  25%|██▌       | 35/138 [00:12<00:36,  2.79chunk/s]Consolidating:  26%|██▌       | 36/138 [00:12<00:36,  2.77chunk/s]Consolidating:  27%|██▋       | 37/138 [00:13<00:36,  2.76chunk/s]Consolidating:  28%|██▊       | 38/138 [00:13<00:36,  2.75chunk/s]Consolidating:  28%|██▊       | 39/138 [00:14<00:36,  2.74chunk/s]Consolidating:  29%|██▉       | 40/138 [00:14<00:35,  2.74chunk/s]Consolidating:  30%|██▉       | 41/138 [00:14<00:35,  2.72chunk/s]Consolidating:  30%|███       | 42/138 [00:15<00:35,  2.72chunk/s]Consolidating:  31%|███       | 43/138 [00:15<00:35,  2.71chunk/s]Consolidating:  32%|███▏      | 44/138 [00:15<00:34,  2.71chunk/s]Consolidating:  33%|███▎      | 45/138 [00:16<00:34,  2.71chunk/s]Consolidating:  33%|███▎      | 46/138 [00:16<00:34,  2.70chunk/s]Consolidating:  34%|███▍      | 47/138 [00:17<00:33,  2.69chunk/s]Consolidating:  35%|███▍      | 48/138 [00:17<00:33,  2.69chunk/s]Consolidating:  36%|███▌      | 49/138 [00:17<00:33,  2.69chunk/s]Consolidating:  36%|███▌      | 50/138 [00:18<00:32,  2.69chunk/s]Consolidating:  37%|███▋      | 51/138 [00:18<00:32,  2.69chunk/s]Consolidating:  38%|███▊      | 52/138 [00:18<00:32,  2.68chunk/s]Consolidating:  38%|███▊      | 53/138 [00:19<00:31,  2.69chunk/s]Consolidating:  39%|███▉      | 54/138 [00:19<00:31,  2.67chunk/s]Consolidating:  40%|███▉      | 55/138 [00:19<00:31,  2.67chunk/s]Consolidating:  41%|████      | 56/138 [00:20<00:30,  2.69chunk/s]Consolidating:  41%|████▏     | 57/138 [00:20<00:30,  2.68chunk/s]Consolidating:  42%|████▏     | 58/138 [00:21<00:29,  2.68chunk/s]Consolidating:  43%|████▎     | 59/138 [00:21<00:29,  2.68chunk/s]Consolidating:  43%|████▎     | 60/138 [00:21<00:28,  2.69chunk/s]Consolidating:  44%|████▍     | 61/138 [00:22<00:28,  2.69chunk/s]Consolidating:  45%|████▍     | 62/138 [00:22<00:28,  2.70chunk/s]Consolidating:  46%|████▌     | 63/138 [00:22<00:27,  2.69chunk/s]Consolidating:  46%|████▋     | 64/138 [00:23<00:27,  2.69chunk/s]Consolidating:  47%|████▋     | 65/138 [00:23<00:27,  2.68chunk/s]Consolidating:  48%|████▊     | 66/138 [00:24<00:26,  2.68chunk/s]Consolidating:  49%|████▊     | 67/138 [00:24<00:26,  2.66chunk/s]Consolidating:  49%|████▉     | 68/138 [00:24<00:26,  2.67chunk/s]Consolidating:  50%|█████     | 69/138 [00:25<00:26,  2.65chunk/s]Consolidating:  51%|█████     | 70/138 [00:25<00:25,  2.63chunk/s]Consolidating:  51%|█████▏    | 71/138 [00:25<00:25,  2.65chunk/s]Consolidating:  52%|█████▏    | 72/138 [00:26<00:24,  2.65chunk/s]Consolidating:  53%|█████▎    | 73/138 [00:26<00:24,  2.65chunk/s]Consolidating:  54%|█████▎    | 74/138 [00:27<00:24,  2.66chunk/s]Consolidating:  54%|█████▍    | 75/138 [00:27<00:23,  2.66chunk/s]Consolidating:  55%|█████▌    | 76/138 [00:27<00:23,  2.65chunk/s]Consolidating:  56%|█████▌    | 77/138 [00:28<00:22,  2.66chunk/s]Consolidating:  57%|█████▋    | 78/138 [00:28<00:22,  2.67chunk/s]Consolidating:  57%|█████▋    | 79/138 [00:28<00:22,  2.67chunk/s]Consolidating:  58%|█████▊    | 80/138 [00:29<00:21,  2.67chunk/s]Consolidating:  59%|█████▊    | 81/138 [00:29<00:21,  2.65chunk/s]Consolidating:  59%|█████▉    | 82/138 [00:30<00:21,  2.65chunk/s]Consolidating:  60%|██████    | 83/138 [00:30<00:20,  2.64chunk/s]Consolidating:  61%|██████    | 84/138 [00:31<00:23,  2.33chunk/s]Consolidating:  62%|██████▏   | 85/138 [00:31<00:21,  2.42chunk/s]Consolidating:  62%|██████▏   | 86/138 [00:31<00:20,  2.48chunk/s]Consolidating:  63%|██████▎   | 87/138 [00:32<00:20,  2.53chunk/s]Consolidating:  64%|██████▍   | 88/138 [00:32<00:19,  2.56chunk/s]Consolidating:  64%|██████▍   | 89/138 [00:33<00:33,  1.46chunk/s]Consolidating:  65%|██████▌   | 90/138 [00:40<01:57,  2.45s/chunk]Consolidating:  66%|██████▌   | 91/138 [00:47<03:02,  3.89s/chunk]Consolidating:  67%|██████▋   | 92/138 [00:55<03:53,  5.07s/chunk]Consolidating:  67%|██████▋   | 93/138 [01:03<04:27,  5.94s/chunk]Consolidating:  68%|██████▊   | 94/138 [01:11<04:41,  6.40s/chunk]Consolidating:  69%|██████▉   | 95/138 [01:11<03:17,  4.59s/chunk]Consolidating:  70%|██████▉   | 96/138 [01:11<02:19,  3.33s/chunk]Consolidating:  70%|███████   | 97/138 [01:12<01:40,  2.45s/chunk]Consolidating:  71%|███████   | 98/138 [01:12<01:13,  1.83s/chunk]Consolidating:  72%|███████▏  | 99/138 [01:12<00:54,  1.40s/chunk]Consolidating:  72%|███████▏  | 100/138 [01:13<00:41,  1.09s/chunk]Consolidating:  73%|███████▎  | 101/138 [01:13<00:32,  1.14chunk/s]Consolidating:  74%|███████▍  | 102/138 [01:14<00:26,  1.37chunk/s]Consolidating:  75%|███████▍  | 103/138 [01:14<00:21,  1.59chunk/s]Consolidating:  75%|███████▌  | 104/138 [01:14<00:18,  1.80chunk/s]Consolidating:  76%|███████▌  | 105/138 [01:15<00:16,  1.98chunk/s]Consolidating:  77%|███████▋  | 106/138 [01:15<00:15,  2.13chunk/s]Consolidating:  78%|███████▊  | 107/138 [01:16<00:13,  2.25chunk/s]Consolidating:  78%|███████▊  | 108/138 [01:16<00:12,  2.35chunk/s]Consolidating:  79%|███████▉  | 109/138 [01:16<00:11,  2.42chunk/s]Consolidating:  80%|███████▉  | 110/138 [01:17<00:11,  2.48chunk/s]Consolidating:  80%|████████  | 111/138 [01:17<00:10,  2.53chunk/s]Consolidating:  81%|████████  | 112/138 [01:17<00:10,  2.55chunk/s]Consolidating:  82%|████████▏ | 113/138 [01:18<00:09,  2.57chunk/s]Consolidating:  83%|████████▎ | 114/138 [01:18<00:09,  2.56chunk/s]Consolidating:  83%|████████▎ | 115/138 [01:19<00:08,  2.56chunk/s]Consolidating:  84%|████████▍ | 116/138 [01:19<00:08,  2.56chunk/s]Consolidating:  85%|████████▍ | 117/138 [01:19<00:08,  2.56chunk/s]Consolidating:  86%|████████▌ | 118/138 [01:20<00:07,  2.57chunk/s]Consolidating:  86%|████████▌ | 119/138 [01:20<00:07,  2.58chunk/s]Consolidating:  87%|████████▋ | 120/138 [01:21<00:06,  2.59chunk/s]Consolidating:  88%|████████▊ | 121/138 [01:21<00:06,  2.59chunk/s]Consolidating:  88%|████████▊ | 122/138 [01:21<00:06,  2.57chunk/s]Consolidating:  89%|████████▉ | 123/138 [01:22<00:05,  2.56chunk/s]Consolidating:  90%|████████▉ | 124/138 [01:22<00:05,  2.56chunk/s]Consolidating:  91%|█████████ | 125/138 [01:22<00:05,  2.56chunk/s]Consolidating:  91%|█████████▏| 126/138 [01:23<00:04,  2.57chunk/s]Consolidating:  92%|█████████▏| 127/138 [01:23<00:04,  2.58chunk/s]Consolidating:  93%|█████████▎| 128/138 [01:24<00:03,  2.50chunk/s]Consolidating:  93%|█████████▎| 129/138 [01:24<00:03,  2.52chunk/s]Consolidating:  94%|█████████▍| 130/138 [01:24<00:03,  2.52chunk/s]Consolidating:  95%|█████████▍| 131/138 [01:25<00:02,  2.54chunk/s]Consolidating:  96%|█████████▌| 132/138 [01:25<00:02,  2.52chunk/s]Consolidating:  96%|█████████▋| 133/138 [01:26<00:01,  2.54chunk/s]Consolidating:  97%|█████████▋| 134/138 [01:26<00:01,  2.43chunk/s]Consolidating:  98%|█████████▊| 135/138 [01:26<00:01,  2.47chunk/s]Consolidating:  99%|█████████▊| 136/138 [01:27<00:00,  2.50chunk/s]Consolidating:  99%|█████████▉| 137/138 [01:27<00:00,  2.52chunk/s]Consolidating: 100%|██████████| 138/138 [01:28<00:00,  2.81chunk/s]Consolidating: 100%|██████████| 138/138 [01:28<00:00,  1.57chunk/s]
[After consolidation] CPU: 4.68GB
[mmap] Consolidated 1,375,099 embeddings to cluster_out_v7_astrobert/consolidated_embeddings.dat
[mmap] Loaded embeddings shape: (1375099, 768)
[umap] dim=50 n_neighbors=50
CUML not available, falling back to CPU UMAP
[Before CPU UMAP] CPU: 0.75GB
[CPU-UMAP] Attempting to load 1,375,099 points into memory
UMAP(angular_rp_forest=True, metric='cosine', min_dist=0.05, n_components=50, n_neighbors=50, random_state=42, verbose=True)
Sun Sep  7 19:05:52 2025 Construct fuzzy simplicial set
Sun Sep  7 19:05:53 2025 Finding Nearest Neighbors
Sun Sep  7 19:05:54 2025 Building RP forest with 64 trees
Sun Sep  7 19:07:46 2025 NN descent for 20 iterations
	 1  /  20
	 2  /  20
	 3  /  20
	Stopping threshold met -- exiting after 3 iterations
Sun Sep  7 19:13:10 2025 Finished Nearest Neighbor Search
Sun Sep  7 19:13:43 2025 Construct embedding
Epochs completed:   0%|            0/200 [00:00]Epochs completed:   0%|            1/200 [00:00]Epochs completed:   1%|            2/200 [00:03]Epochs completed:   2%| ▏          3/200 [00:12]Epochs completed:   2%| ▏          4/200 [00:23]Epochs completed:   2%| ▎          5/200 [00:36]Epochs completed:   3%| ▎          6/200 [00:50]Epochs completed:   4%| ▎          7/200 [01:05]Epochs completed:   4%| ▍          8/200 [01:21]Epochs completed:   4%| ▍          9/200 [01:37]Epochs completed:   5%| ▌          10/200 [01:54]Epochs completed:   6%| ▌          11/200 [02:12]Epochs completed:   6%| ▌          12/200 [02:30]Epochs completed:   6%| ▋          13/200 [02:48]Epochs completed:   7%| ▋          14/200 [03:07]Epochs completed:   8%| ▊          15/200 [03:26]Epochs completed:   8%| ▊          16/200 [03:45]Epochs completed:   8%| ▊          17/200 [04:05]Epochs completed:   9%| ▉          18/200 [04:24]Epochs completed:  10%| ▉          19/200 [04:44]Epochs completed:  10%| █          20/200 [05:04]Epochs completed:  10%| █          21/200 [05:24]Epochs completed:  11%| █          22/200 [05:44]Epochs completed:  12%| █▏         23/200 [06:04]Epochs completed:  12%| █▏         24/200 [06:24]Epochs completed:  12%| █▎         25/200 [06:44]Epochs completed:  13%| █▎         26/200 [07:05]Epochs completed:  14%| █▎         27/200 [07:25]Epochs completed:  14%| █▍         28/200 [07:45]Epochs completed:  14%| █▍         29/200 [08:05]Epochs completed:  15%| █▌         30/200 [08:25]Epochs completed:  16%| █▌         31/200 [08:46]Epochs completed:  16%| █▌         32/200 [09:06]Epochs completed:  16%| █▋         33/200 [09:26]Epochs completed:  17%| █▋         34/200 [09:46]Epochs completed:  18%| █▊         35/200 [10:07]Epochs completed:  18%| █▊         36/200 [10:27]Epochs completed:  18%| █▊         37/200 [10:48]Epochs completed:  19%| █▉         38/200 [11:08]Epochs completed:  20%| █▉         39/200 [11:29]Epochs completed:  20%| ██         40/200 [11:49]Epochs completed:  20%| ██         41/200 [12:10]Epochs completed:  21%| ██         42/200 [12:30]Epochs completed:  22%| ██▏        43/200 [12:51]Epochs completed:  22%| ██▏        44/200 [13:11]Epochs completed:  22%| ██▎        45/200 [13:32]Epochs completed:  23%| ██▎        46/200 [13:52]Epochs completed:  24%| ██▎        47/200 [14:13]Epochs completed:  24%| ██▍        48/200 [14:34]Epochs completed:  24%| ██▍        49/200 [14:54]Epochs completed:  25%| ██▌        50/200 [15:15]Epochs completed:  26%| ██▌        51/200 [15:35]Epochs completed:  26%| ██▌        52/200 [15:56]Epochs completed:  26%| ██▋        53/200 [16:16]Epochs completed:  27%| ██▋        54/200 [16:37]Epochs completed:  28%| ██▊        55/200 [16:57]Epochs completed:  28%| ██▊        56/200 [17:18]Epochs completed:  28%| ██▊        57/200 [17:38]Epochs completed:  29%| ██▉        58/200 [17:59]Epochs completed:  30%| ██▉        59/200 [18:19]Epochs completed:  30%| ███        60/200 [18:40]Epochs completed:  30%| ███        61/200 [19:01]Epochs completed:  31%| ███        62/200 [19:21]Epochs completed:  32%| ███▏       63/200 [19:42]Epochs completed:  32%| ███▏       64/200 [20:03]Epochs completed:  32%| ███▎       65/200 [20:23]Epochs completed:  33%| ███▎       66/200 [20:44]Epochs completed:  34%| ███▎       67/200 [21:04]Epochs completed:  34%| ███▍       68/200 [21:25]Epochs completed:  34%| ███▍       69/200 [21:46]Epochs completed:  35%| ███▌       70/200 [22:06]Epochs completed:  36%| ███▌       71/200 [22:27]Epochs completed:  36%| ███▌       72/200 [22:48]Epochs completed:  36%| ███▋       73/200 [23:09]Epochs completed:  37%| ███▋       74/200 [23:30]Epochs completed:  38%| ███▊       75/200 [23:50]Epochs completed:  38%| ███▊       76/200 [24:11]Epochs completed:  38%| ███▊       77/200 [24:32]Epochs completed:  39%| ███▉       78/200 [24:53]Epochs completed:  40%| ███▉       79/200 [25:13]Epochs completed:  40%| ████       80/200 [25:34]Epochs completed:  40%| ████       81/200 [25:55]Epochs completed:  41%| ████       82/200 [26:16]Epochs completed:  42%| ████▏      83/200 [26:36]Epochs completed:  42%| ████▏      84/200 [26:57]Epochs completed:  42%| ████▎      85/200 [27:18]Epochs completed:  43%| ████▎      86/200 [27:39]Epochs completed:  44%| ████▎      87/200 [27:59]Epochs completed:  44%| ████▍      88/200 [28:20]Epochs completed:  44%| ████▍      89/200 [28:41]Epochs completed:  45%| ████▌      90/200 [29:01]Epochs completed:  46%| ████▌      91/200 [29:22]Epochs completed:  46%| ████▌      92/200 [29:43]Epochs completed:  46%| ████▋      93/200 [30:03]Epochs completed:  47%| ████▋      94/200 [30:24]Epochs completed:  48%| ████▊      95/200 [30:45]Epochs completed:  48%| ████▊      96/200 [31:05]Epochs completed:  48%| ████▊      97/200 [31:26]Epochs completed:  49%| ████▉      98/200 [31:47]Epochs completed:  50%| ████▉      99/200 [32:07]Epochs completed:  50%| █████      100/200 [32:28]Epochs completed:  50%| █████      101/200 [32:49]Epochs completed:  51%| █████      102/200 [33:10]Epochs completed:  52%| █████▏     103/200 [33:31]Epochs completed:  52%| █████▏     104/200 [33:51]Epochs completed:  52%| █████▎     105/200 [34:12]Epochs completed:  53%| █████▎     106/200 [34:33]Epochs completed:  54%| █████▎     107/200 [34:54]Epochs completed:  54%| █████▍     108/200 [35:15]Epochs completed:  55%| █████▍     109/200 [35:35]Epochs completed:  55%| █████▌     110/200 [35:56]Epochs completed:  56%| █████▌     111/200 [36:16]Epochs completed:  56%| █████▌     112/200 [36:37]Epochs completed:  56%| █████▋     113/200 [36:57]Epochs completed:  57%| █████▋     114/200 [37:18]Epochs completed:  57%| █████▊     115/200 [37:39]Epochs completed:  58%| █████▊     116/200 [37:59]Epochs completed:  58%| █████▊     117/200 [38:20]Epochs completed:  59%| █████▉     118/200 [38:40]Epochs completed:  60%| █████▉     119/200 [39:01]Epochs completed:  60%| ██████     120/200 [39:22]Epochs completed:  60%| ██████     121/200 [39:42]Epochs completed:  61%| ██████     122/200 [40:03]Epochs completed:  62%| ██████▏    123/200 [40:23]Epochs completed:  62%| ██████▏    124/200 [40:44]Epochs completed:  62%| ██████▎    125/200 [41:05]Epochs completed:  63%| ██████▎    126/200 [41:25]Epochs completed:  64%| ██████▎    127/200 [41:46]Epochs completed:  64%| ██████▍    128/200 [42:07]Epochs completed:  64%| ██████▍    129/200 [42:28]Epochs completed:  65%| ██████▌    130/200 [42:48]Epochs completed:  66%| ██████▌    131/200 [43:09]Epochs completed:  66%| ██████▌    132/200 [43:30]Epochs completed:  66%| ██████▋    133/200 [43:51]Epochs completed:  67%| ██████▋    134/200 [44:12]Epochs completed:  68%| ██████▊    135/200 [44:32]Epochs completed:  68%| ██████▊    136/200 [44:53]Epochs completed:  68%| ██████▊    137/200 [45:14]Epochs completed:  69%| ██████▉    138/200 [45:35]Epochs completed:  70%| ██████▉    139/200 [45:56]Epochs completed:  70%| ███████    140/200 [46:17]Epochs completed:  70%| ███████    141/200 [46:38]Epochs completed:  71%| ███████    142/200 [46:58]Epochs completed:  72%| ███████▏   143/200 [47:19]Epochs completed:  72%| ███████▏   144/200 [47:40]Epochs completed:  72%| ███████▎   145/200 [48:01]Epochs completed:  73%| ███████▎   146/200 [48:22]Epochs completed:  74%| ███████▎   147/200 [48:43]Epochs completed:  74%| ███████▍   148/200 [49:04]Epochs completed:  74%| ███████▍   149/200 [49:24]Epochs completed:  75%| ███████▌   150/200 [49:45]Epochs completed:  76%| ███████▌   151/200 [50:06]Epochs completed:  76%| ███████▌   152/200 [50:27]Epochs completed:  76%| ███████▋   153/200 [50:48]Epochs completed:  77%| ███████▋   154/200 [51:09]Epochs completed:  78%| ███████▊   155/200 [51:29]Epochs completed:  78%| ███████▊   156/200 [51:50]Epochs completed:  78%| ███████▊   157/200 [52:11]Epochs completed:  79%| ███████▉   158/200 [52:32]Epochs completed:  80%| ███████▉   159/200 [52:53]Epochs completed:  80%| ████████   160/200 [53:14]Epochs completed:  80%| ████████   161/200 [53:34]Epochs completed:  81%| ████████   162/200 [53:55]Epochs completed:  82%| ████████▏  163/200 [54:16]Epochs completed:  82%| ████████▏  164/200 [54:37]Epochs completed:  82%| ████████▎  165/200 [54:58]Epochs completed:  83%| ████████▎  166/200 [55:19]Epochs completed:  84%| ████████▎  167/200 [55:39]Epochs completed:  84%| ████████▍  168/200 [56:00]Epochs completed:  84%| ████████▍  169/200 [56:21]Epochs completed:  85%| ████████▌  170/200 [56:42]Epochs completed:  86%| ████████▌  171/200 [57:02]Epochs completed:  86%| ████████▌  172/200 [57:23]Epochs completed:  86%| ████████▋  173/200 [57:44]Epochs completed:  87%| ████████▋  174/200 [58:05]Epochs completed:  88%| ████████▊  175/200 [58:26]Epochs completed:  88%| ████████▊  176/200 [58:47]Epochs completed:  88%| ████████▊  177/200 [59:08]Epochs completed:  89%| ████████▉  178/200 [59:29]Epochs completed:  90%| ████████▉  179/200 [59:50]Epochs completed:  90%| █████████  180/200 [1:00:11]Epochs completed:  90%| █████████  181/200 [1:00:31]Epochs completed:  91%| █████████  182/200 [1:00:52]Epochs completed:  92%| █████████▏ 183/200 [1:01:13]Epochs completed:  92%| █████████▏ 184/200 [1:01:34]Epochs completed:  92%| █████████▎ 185/200 [1:01:54]Epochs completed:  93%| █████████▎ 186/200 [1:02:15]Epochs completed:  94%| █████████▎ 187/200 [1:02:36]Epochs completed:  94%| █████████▍ 188/200 [1:02:57]Epochs completed:  94%| █████████▍ 189/200 [1:03:17]Epochs completed:  95%| █████████▌ 190/200 [1:03:38]Epochs completed:  96%| █████████▌ 191/200 [1:03:59]Epochs completed:  96%| █████████▌ 192/200 [1:04:19]Epochs completed:  96%| █████████▋ 193/200 [1:04:40]Epochs completed:  97%| █████████▋ 194/200 [1:05:01]Epochs completed:  98%| █████████▊ 195/200 [1:05:22]Epochs completed:  98%| █████████▊ 196/200 [1:05:42]Epochs completed:  98%| █████████▊ 197/200 [1:06:03]Epochs completed:  99%| █████████▉ 198/200 [1:06:24]Epochs completed: 100%| █████████▉ 199/200 [1:06:44]Epochs completed: 100%| ██████████ 200/200 [1:07:05]Epochs completed: 100%| ██████████ 200/200 [1:07:05]
Sun Sep  7 20:42:05 2025 Finished embedding
[After CPU UMAP] CPU: 24.11GB
[hdbscan] metric=euclidean min_cluster_size=500
CUML not available, falling back to CPU HDBSCAN
[Before CPU HDBSCAN] CPU: 6.11GB
[CPU-HDBSCAN] Clustering 1,375,099 points with metric=euclidean
[After CPU HDBSCAN] CPU: 6.15GB

============================================================
CLUSTERING RESULTS
============================================================
{
  "paragraphs": 1375099,
  "clusters": 191,
  "noise": 854476,
  "noise_pct": 62.14,
  "avg_cluster_size": 2725.77,
  "median_cluster_size": 1395,
  "min_cluster_size": 502,
  "max_cluster_size": 44471
}
============================================================

[write] Labels saved to: cluster_out_v7_astrobert/labels_paragraph.csv
[write] Summary saved to: cluster_out_v7_astrobert/cluster_summary.json
[write] Config saved to: cluster_out_v7_astrobert/cluster_config.json
[Script end] CPU: 6.11GB

✓ Memory-optimized clustering completed successfully!
