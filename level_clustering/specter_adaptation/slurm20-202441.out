/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[Script start] CPU: 0.61GB | GPU: 0.00GB used / 0.00GB total
[GPU] Forcing CPU usage
[scan] Using 138 shard folders
[enhance] Method enhancement: True
[Before consolidation] CPU: 0.61GB
[enhance] Pre-combining embeddings with methodological features...
[enhance] Collecting all texts for feature extraction...
Collecting texts:   0%|          | 0/138 [00:00<?, ?chunk/s]Collecting texts:   2%|▏         | 3/138 [00:00<00:06, 21.57chunk/s]Collecting texts:   4%|▍         | 6/138 [00:00<00:06, 21.34chunk/s]Collecting texts:   7%|▋         | 9/138 [00:00<00:06, 21.39chunk/s]Collecting texts:   9%|▊         | 12/138 [00:00<00:05, 21.11chunk/s]Collecting texts:  11%|█         | 15/138 [00:00<00:05, 21.15chunk/s]Collecting texts:  13%|█▎        | 18/138 [00:00<00:05, 21.15chunk/s]Collecting texts:  15%|█▌        | 21/138 [00:00<00:05, 21.11chunk/s]Collecting texts:  17%|█▋        | 24/138 [00:01<00:05, 21.08chunk/s]Collecting texts:  20%|█▉        | 27/138 [00:01<00:05, 21.25chunk/s]Collecting texts:  22%|██▏       | 30/138 [00:01<00:05, 21.28chunk/s]Collecting texts:  24%|██▍       | 33/138 [00:01<00:04, 21.05chunk/s]Collecting texts:  26%|██▌       | 36/138 [00:01<00:04, 20.95chunk/s]Collecting texts:  28%|██▊       | 39/138 [00:01<00:04, 21.03chunk/s]Collecting texts:  30%|███       | 42/138 [00:01<00:04, 21.15chunk/s]Collecting texts:  33%|███▎      | 45/138 [00:02<00:04, 21.27chunk/s]Collecting texts:  35%|███▍      | 48/138 [00:02<00:04, 21.39chunk/s]Collecting texts:  37%|███▋      | 51/138 [00:02<00:04, 21.37chunk/s]Collecting texts:  39%|███▉      | 54/138 [00:02<00:03, 21.35chunk/s]Collecting texts:  41%|████▏     | 57/138 [00:02<00:03, 21.28chunk/s]Collecting texts:  43%|████▎     | 60/138 [00:02<00:03, 21.29chunk/s]Collecting texts:  46%|████▌     | 63/138 [00:02<00:03, 21.33chunk/s]Collecting texts:  48%|████▊     | 66/138 [00:03<00:03, 21.23chunk/s]Collecting texts:  50%|█████     | 69/138 [00:03<00:03, 21.12chunk/s]Collecting texts:  52%|█████▏    | 72/138 [00:03<00:03, 21.04chunk/s]Collecting texts:  54%|█████▍    | 75/138 [00:03<00:03, 20.95chunk/s]Collecting texts:  57%|█████▋    | 78/138 [00:03<00:02, 21.06chunk/s]Collecting texts:  59%|█████▊    | 81/138 [00:03<00:02, 21.03chunk/s]Collecting texts:  61%|██████    | 84/138 [00:03<00:02, 21.07chunk/s]Collecting texts:  63%|██████▎   | 87/138 [00:04<00:02, 20.84chunk/s]Collecting texts:  65%|██████▌   | 90/138 [00:04<00:02, 20.87chunk/s]Collecting texts:  67%|██████▋   | 93/138 [00:04<00:02, 20.84chunk/s]Collecting texts:  70%|██████▉   | 96/138 [00:04<00:02, 20.89chunk/s]Collecting texts:  72%|███████▏  | 99/138 [00:04<00:01, 20.92chunk/s]Collecting texts:  74%|███████▍  | 102/138 [00:04<00:01, 20.84chunk/s]Collecting texts:  76%|███████▌  | 105/138 [00:04<00:01, 20.91chunk/s]Collecting texts:  78%|███████▊  | 108/138 [00:05<00:01, 20.85chunk/s]Collecting texts:  80%|████████  | 111/138 [00:05<00:01, 20.85chunk/s]Collecting texts:  83%|████████▎ | 114/138 [00:05<00:01, 20.82chunk/s]Collecting texts:  85%|████████▍ | 117/138 [00:05<00:01, 20.91chunk/s]Collecting texts:  87%|████████▋ | 120/138 [00:05<00:00, 20.70chunk/s]Collecting texts:  89%|████████▉ | 123/138 [00:05<00:00, 20.82chunk/s]Collecting texts:  91%|█████████▏| 126/138 [00:05<00:00, 20.85chunk/s]Collecting texts:  93%|█████████▎| 129/138 [00:06<00:00, 20.94chunk/s]Collecting texts:  96%|█████████▌| 132/138 [00:06<00:00, 20.88chunk/s]Collecting texts:  98%|█████████▊| 135/138 [00:06<00:00, 20.77chunk/s]Collecting texts: 100%|██████████| 138/138 [00:06<00:00, 21.42chunk/s]Collecting texts: 100%|██████████| 138/138 [00:06<00:00, 21.07chunk/s]
[enhance] Extracting method features for 1375099 texts...
[method] Extracting methodological features...
Extracting features:   0%|          | 0/138 [00:00<?, ?it/s]Extracting features:   1%|          | 1/138 [00:00<01:22,  1.67it/s]Extracting features:   1%|▏         | 2/138 [00:01<01:09,  1.96it/s]Extracting features:   2%|▏         | 3/138 [00:01<01:04,  2.08it/s]Extracting features:   3%|▎         | 4/138 [00:01<01:02,  2.14it/s]Extracting features:   4%|▎         | 5/138 [00:02<01:01,  2.18it/s]Extracting features:   4%|▍         | 6/138 [00:02<00:59,  2.20it/s]Extracting features:   5%|▌         | 7/138 [00:03<00:59,  2.22it/s]Extracting features:   6%|▌         | 8/138 [00:03<00:58,  2.23it/s]Extracting features:   7%|▋         | 9/138 [00:04<00:57,  2.24it/s]Extracting features:   7%|▋         | 10/138 [00:04<00:56,  2.25it/s]Extracting features:   8%|▊         | 11/138 [00:05<01:02,  2.05it/s]Extracting features:   9%|▊         | 12/138 [00:05<00:59,  2.11it/s]Extracting features:   9%|▉         | 13/138 [00:06<00:58,  2.15it/s]Extracting features:  10%|█         | 14/138 [00:06<00:56,  2.18it/s]Extracting features:  11%|█         | 15/138 [00:06<00:55,  2.20it/s]Extracting features:  12%|█▏        | 16/138 [00:07<00:55,  2.22it/s]Extracting features:  12%|█▏        | 17/138 [00:07<00:54,  2.23it/s]Extracting features:  13%|█▎        | 18/138 [00:08<00:53,  2.24it/s]Extracting features:  14%|█▍        | 19/138 [00:08<00:52,  2.25it/s]Extracting features:  14%|█▍        | 20/138 [00:09<00:52,  2.25it/s]Extracting features:  15%|█▌        | 21/138 [00:09<00:57,  2.05it/s]Extracting features:  16%|█▌        | 22/138 [00:10<00:55,  2.11it/s]Extracting features:  17%|█▋        | 23/138 [00:10<00:53,  2.15it/s]Extracting features:  17%|█▋        | 24/138 [00:11<00:52,  2.18it/s]Extracting features:  18%|█▊        | 25/138 [00:11<00:51,  2.20it/s]Extracting features:  19%|█▉        | 26/138 [00:11<00:50,  2.21it/s]Extracting features:  20%|█▉        | 27/138 [00:12<00:49,  2.22it/s]Extracting features:  20%|██        | 28/138 [00:12<00:49,  2.23it/s]Extracting features:  21%|██        | 29/138 [00:13<00:48,  2.23it/s]Extracting features:  22%|██▏       | 30/138 [00:13<00:48,  2.24it/s]Extracting features:  22%|██▏       | 31/138 [00:14<00:52,  2.04it/s]Extracting features:  23%|██▎       | 32/138 [00:14<00:50,  2.10it/s]Extracting features:  24%|██▍       | 33/138 [00:15<00:49,  2.14it/s]Extracting features:  25%|██▍       | 34/138 [00:15<00:48,  2.17it/s]Extracting features:  25%|██▌       | 35/138 [00:16<00:47,  2.18it/s]Extracting features:  26%|██▌       | 36/138 [00:16<00:46,  2.20it/s]Extracting features:  27%|██▋       | 37/138 [00:17<00:45,  2.22it/s]Extracting features:  28%|██▊       | 38/138 [00:17<00:44,  2.22it/s]Extracting features:  28%|██▊       | 39/138 [00:17<00:44,  2.23it/s]Extracting features:  29%|██▉       | 40/138 [00:18<00:43,  2.23it/s]Extracting features:  30%|██▉       | 41/138 [00:18<00:47,  2.03it/s]Extracting features:  30%|███       | 42/138 [00:19<00:45,  2.09it/s]Extracting features:  31%|███       | 43/138 [00:19<00:44,  2.14it/s]Extracting features:  32%|███▏      | 44/138 [00:20<00:43,  2.16it/s]Extracting features:  33%|███▎      | 45/138 [00:20<00:42,  2.19it/s]Extracting features:  33%|███▎      | 46/138 [00:21<00:41,  2.20it/s]Extracting features:  34%|███▍      | 47/138 [00:21<00:41,  2.20it/s]Extracting features:  35%|███▍      | 48/138 [00:22<00:40,  2.21it/s]Extracting features:  36%|███▌      | 49/138 [00:22<00:40,  2.21it/s]Extracting features:  36%|███▌      | 50/138 [00:23<00:39,  2.21it/s]Extracting features:  37%|███▋      | 51/138 [00:23<00:43,  2.02it/s]Extracting features:  38%|███▊      | 52/138 [00:24<00:41,  2.08it/s]Extracting features:  38%|███▊      | 53/138 [00:24<00:39,  2.13it/s]Extracting features:  39%|███▉      | 54/138 [00:24<00:38,  2.16it/s]Extracting features:  40%|███▉      | 55/138 [00:25<00:37,  2.19it/s]Extracting features:  41%|████      | 56/138 [00:25<00:37,  2.21it/s]Extracting features:  41%|████▏     | 57/138 [00:26<00:36,  2.22it/s]Extracting features:  42%|████▏     | 58/138 [00:26<00:35,  2.23it/s]Extracting features:  43%|████▎     | 59/138 [00:27<00:35,  2.23it/s]Extracting features:  43%|████▎     | 60/138 [00:27<00:34,  2.23it/s]Extracting features:  44%|████▍     | 61/138 [00:28<00:37,  2.03it/s]Extracting features:  45%|████▍     | 62/138 [00:28<00:36,  2.09it/s]Extracting features:  46%|████▌     | 63/138 [00:29<00:35,  2.13it/s]Extracting features:  46%|████▋     | 64/138 [00:29<00:34,  2.16it/s]Extracting features:  47%|████▋     | 65/138 [00:29<00:33,  2.18it/s]Extracting features:  48%|████▊     | 66/138 [00:30<00:32,  2.19it/s]Extracting features:  49%|████▊     | 67/138 [00:30<00:32,  2.20it/s]Extracting features:  49%|████▉     | 68/138 [00:31<00:31,  2.21it/s]Extracting features:  50%|█████     | 69/138 [00:31<00:31,  2.21it/s]Extracting features:  51%|█████     | 70/138 [00:32<00:30,  2.22it/s]Extracting features:  51%|█████▏    | 71/138 [00:32<00:33,  2.02it/s]Extracting features:  52%|█████▏    | 72/138 [00:33<00:31,  2.07it/s]Extracting features:  53%|█████▎    | 73/138 [00:33<00:30,  2.11it/s]Extracting features:  54%|█████▎    | 74/138 [00:34<00:29,  2.14it/s]Extracting features:  54%|█████▍    | 75/138 [00:34<00:29,  2.16it/s]Extracting features:  55%|█████▌    | 76/138 [00:35<00:28,  2.17it/s]Extracting features:  56%|█████▌    | 77/138 [00:35<00:27,  2.19it/s]Extracting features:  57%|█████▋    | 78/138 [00:36<00:27,  2.19it/s]Extracting features:  57%|█████▋    | 79/138 [00:36<00:26,  2.20it/s]Extracting features:  58%|█████▊    | 80/138 [00:36<00:26,  2.20it/s]Extracting features:  59%|█████▊    | 81/138 [00:37<00:28,  2.01it/s]Extracting features:  59%|█████▉    | 82/138 [00:37<00:27,  2.06it/s]Extracting features:  60%|██████    | 83/138 [00:38<00:26,  2.10it/s]Extracting features:  61%|██████    | 84/138 [00:38<00:25,  2.13it/s]Extracting features:  62%|██████▏   | 85/138 [00:39<00:24,  2.14it/s]Extracting features:  62%|██████▏   | 86/138 [00:39<00:24,  2.16it/s]Extracting features:  63%|██████▎   | 87/138 [00:40<00:23,  2.16it/s]Extracting features:  64%|██████▍   | 88/138 [00:40<00:23,  2.17it/s]Extracting features:  64%|██████▍   | 89/138 [00:41<00:22,  2.18it/s]Extracting features:  65%|██████▌   | 90/138 [00:41<00:21,  2.18it/s]Extracting features:  66%|██████▌   | 91/138 [00:42<00:23,  2.00it/s]Extracting features:  67%|██████▋   | 92/138 [00:42<00:22,  2.05it/s]Extracting features:  67%|██████▋   | 93/138 [00:43<00:21,  2.09it/s]Extracting features:  68%|██████▊   | 94/138 [00:43<00:20,  2.12it/s]Extracting features:  69%|██████▉   | 95/138 [00:44<00:20,  2.14it/s]Extracting features:  70%|██████▉   | 96/138 [00:44<00:19,  2.16it/s]Extracting features:  70%|███████   | 97/138 [00:44<00:18,  2.17it/s]Extracting features:  71%|███████   | 98/138 [00:45<00:18,  2.18it/s]Extracting features:  72%|███████▏  | 99/138 [00:45<00:17,  2.19it/s]Extracting features:  72%|███████▏  | 100/138 [00:46<00:17,  2.20it/s]Extracting features:  73%|███████▎  | 101/138 [00:46<00:18,  2.02it/s]Extracting features:  74%|███████▍  | 102/138 [00:47<00:17,  2.08it/s]Extracting features:  75%|███████▍  | 103/138 [00:47<00:16,  2.13it/s]Extracting features:  75%|███████▌  | 104/138 [00:48<00:15,  2.16it/s]Extracting features:  76%|███████▌  | 105/138 [00:48<00:15,  2.19it/s]Extracting features:  77%|███████▋  | 106/138 [00:49<00:14,  2.21it/s]Extracting features:  78%|███████▊  | 107/138 [00:49<00:13,  2.22it/s]Extracting features:  78%|███████▊  | 108/138 [00:50<00:13,  2.24it/s]Extracting features:  79%|███████▉  | 109/138 [00:50<00:12,  2.24it/s]Extracting features:  80%|███████▉  | 110/138 [00:50<00:12,  2.24it/s]Extracting features:  80%|████████  | 111/138 [00:51<00:13,  2.04it/s]Extracting features:  81%|████████  | 112/138 [00:51<00:12,  2.10it/s]Extracting features:  82%|████████▏ | 113/138 [00:52<00:11,  2.14it/s]Extracting features:  83%|████████▎ | 114/138 [00:52<00:11,  2.16it/s]Extracting features:  83%|████████▎ | 115/138 [00:53<00:10,  2.19it/s]Extracting features:  84%|████████▍ | 116/138 [00:53<00:09,  2.21it/s]Extracting features:  85%|████████▍ | 117/138 [00:54<00:09,  2.22it/s]Extracting features:  86%|████████▌ | 118/138 [00:54<00:08,  2.23it/s]Extracting features:  86%|████████▌ | 119/138 [00:55<00:08,  2.24it/s]Extracting features:  87%|████████▋ | 120/138 [00:55<00:07,  2.25it/s]Extracting features:  88%|████████▊ | 121/138 [00:56<00:08,  2.05it/s]Extracting features:  88%|████████▊ | 122/138 [00:56<00:07,  2.11it/s]Extracting features:  89%|████████▉ | 123/138 [00:56<00:06,  2.15it/s]Extracting features:  90%|████████▉ | 124/138 [00:57<00:06,  2.18it/s]Extracting features:  91%|█████████ | 125/138 [00:57<00:05,  2.20it/s]Extracting features:  91%|█████████▏| 126/138 [00:58<00:05,  2.22it/s]Extracting features:  92%|█████████▏| 127/138 [00:58<00:04,  2.23it/s]Extracting features:  93%|█████████▎| 128/138 [00:59<00:04,  2.24it/s]Extracting features:  93%|█████████▎| 129/138 [00:59<00:04,  2.24it/s]Extracting features:  94%|█████████▍| 130/138 [01:00<00:03,  2.24it/s]Extracting features:  95%|█████████▍| 131/138 [01:00<00:03,  2.04it/s]Extracting features:  96%|█████████▌| 132/138 [01:01<00:02,  2.09it/s]Extracting features:  96%|█████████▋| 133/138 [01:01<00:02,  2.13it/s]Extracting features:  97%|█████████▋| 134/138 [01:02<00:01,  2.16it/s]Extracting features:  98%|█████████▊| 135/138 [01:02<00:01,  2.18it/s]Extracting features:  99%|█████████▊| 136/138 [01:02<00:00,  2.20it/s]Extracting features:  99%|█████████▉| 137/138 [01:03<00:00,  2.20it/s]Extracting features: 100%|██████████| 138/138 [01:03<00:00,  2.59it/s]Extracting features: 100%|██████████| 138/138 [01:03<00:00,  2.17it/s]
[method] Extracted 6 methodological features
[enhance] Method features shape: (1375099, 6)
[enhance] Creating enhanced embedding files per chunk...
Creating enhanced chunks:   0%|          | 0/138 [00:00<?, ?chunk/s]Creating enhanced chunks:   0%|          | 0/138 [00:00<?, ?chunk/s]
Traceback (most recent call last):
  File "/vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/cluster_chunks_ii.py", line 1081, in <module>
    main()
  File "/vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/cluster_chunks_ii.py", line 935, in main
    mmap_embeddings, para_ids, paper_ids = create_enhanced_embeddings_mmap(
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/cluster_chunks_ii.py", line 303, in create_enhanced_embeddings_mmap
    shutil.copy2(meta_path, enhanced_meta_path)
    ^^^^^^
UnboundLocalError: cannot access local variable 'shutil' where it is not associated with a value
