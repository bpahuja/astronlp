/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[Script start] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
[GPU] Forcing CPU usage
[scan] Using 138 shard folders
[Before consolidation] CPU: 0.60GB
[mmap] Counting total samples...
Counting:   0%|          | 0/138 [00:00<?, ?chunk/s]Counting:  10%|█         | 14/138 [00:00<00:00, 131.49chunk/s]Counting:  20%|██        | 28/138 [00:00<00:00, 133.69chunk/s]Counting:  30%|███       | 42/138 [00:00<00:00, 134.05chunk/s]Counting:  41%|████      | 56/138 [00:00<00:00, 134.41chunk/s]Counting:  51%|█████     | 70/138 [00:00<00:00, 135.00chunk/s]Counting:  61%|██████    | 84/138 [00:00<00:00, 135.13chunk/s]Counting:  71%|███████   | 98/138 [00:00<00:00, 135.33chunk/s]Counting:  81%|████████  | 112/138 [00:00<00:00, 135.54chunk/s]Counting:  91%|█████████▏| 126/138 [00:00<00:00, 135.58chunk/s]Counting: 100%|██████████| 138/138 [00:01<00:00, 135.14chunk/s]
[mmap] Total samples: 687,550, dimensions: 768
[mmap] Consolidating embeddings...
Consolidating:   0%|          | 0/138 [00:00<?, ?chunk/s]Consolidating:   1%|          | 1/138 [00:00<00:41,  3.29chunk/s]Consolidating:   1%|▏         | 2/138 [00:00<00:37,  3.64chunk/s]Consolidating:   2%|▏         | 3/138 [00:00<00:35,  3.77chunk/s]Consolidating:   3%|▎         | 4/138 [00:01<00:34,  3.83chunk/s]Consolidating:   4%|▎         | 5/138 [00:01<00:34,  3.86chunk/s]Consolidating:   4%|▍         | 6/138 [00:01<00:34,  3.88chunk/s]Consolidating:   5%|▌         | 7/138 [00:01<00:33,  3.92chunk/s]Consolidating:   6%|▌         | 8/138 [00:02<00:32,  3.95chunk/s]Consolidating:   7%|▋         | 9/138 [00:02<00:32,  3.97chunk/s]Consolidating:   7%|▋         | 10/138 [00:02<00:32,  3.97chunk/s]Consolidating:   8%|▊         | 11/138 [00:02<00:32,  3.96chunk/s]Consolidating:   9%|▊         | 12/138 [00:03<00:31,  3.96chunk/s]Consolidating:   9%|▉         | 13/138 [00:03<00:31,  3.96chunk/s]Consolidating:  10%|█         | 14/138 [00:03<00:31,  3.94chunk/s]Consolidating:  11%|█         | 15/138 [00:03<00:31,  3.92chunk/s]Consolidating:  12%|█▏        | 16/138 [00:04<00:31,  3.92chunk/s]Consolidating:  12%|█▏        | 17/138 [00:04<00:30,  3.91chunk/s]Consolidating:  13%|█▎        | 18/138 [00:04<00:30,  3.90chunk/s]Consolidating:  14%|█▍        | 19/138 [00:04<00:30,  3.88chunk/s]Consolidating:  14%|█▍        | 20/138 [00:05<00:30,  3.88chunk/s]Consolidating:  15%|█▌        | 21/138 [00:05<00:30,  3.89chunk/s]Consolidating:  16%|█▌        | 22/138 [00:05<00:29,  3.89chunk/s]Consolidating:  17%|█▋        | 23/138 [00:05<00:29,  3.89chunk/s]Consolidating:  17%|█▋        | 24/138 [00:06<00:29,  3.88chunk/s]Consolidating:  18%|█▊        | 25/138 [00:06<00:29,  3.87chunk/s]Consolidating:  19%|█▉        | 26/138 [00:06<00:28,  3.87chunk/s]Consolidating:  20%|█▉        | 27/138 [00:06<00:28,  3.86chunk/s]Consolidating:  20%|██        | 28/138 [00:07<00:28,  3.87chunk/s]Consolidating:  21%|██        | 29/138 [00:07<00:28,  3.87chunk/s]Consolidating:  22%|██▏       | 30/138 [00:07<00:27,  3.87chunk/s]Consolidating:  22%|██▏       | 31/138 [00:07<00:27,  3.86chunk/s]Consolidating:  23%|██▎       | 32/138 [00:08<00:27,  3.88chunk/s]Consolidating:  24%|██▍       | 33/138 [00:08<00:27,  3.86chunk/s]Consolidating:  25%|██▍       | 34/138 [00:08<00:26,  3.86chunk/s]Consolidating:  25%|██▌       | 35/138 [00:09<00:26,  3.85chunk/s]Consolidating:  26%|██▌       | 36/138 [00:09<00:26,  3.85chunk/s]Consolidating:  27%|██▋       | 37/138 [00:09<00:26,  3.86chunk/s]Consolidating:  28%|██▊       | 38/138 [00:09<00:26,  3.72chunk/s]Consolidating:  28%|██▊       | 39/138 [00:10<00:27,  3.62chunk/s]Consolidating:  29%|██▉       | 40/138 [00:10<00:27,  3.57chunk/s]Consolidating:  30%|██▉       | 41/138 [00:10<00:27,  3.52chunk/s]Consolidating:  30%|███       | 42/138 [00:10<00:27,  3.48chunk/s]Consolidating:  31%|███       | 43/138 [00:11<00:26,  3.53chunk/s]Consolidating:  32%|███▏      | 44/138 [00:11<00:26,  3.57chunk/s]Consolidating:  33%|███▎      | 45/138 [00:11<00:25,  3.64chunk/s]Consolidating:  33%|███▎      | 46/138 [00:12<00:24,  3.68chunk/s]Consolidating:  34%|███▍      | 47/138 [00:12<00:24,  3.70chunk/s]Consolidating:  35%|███▍      | 48/138 [00:12<00:24,  3.70chunk/s]Consolidating:  36%|███▌      | 49/138 [00:12<00:23,  3.71chunk/s]Consolidating:  36%|███▌      | 50/138 [00:13<00:23,  3.71chunk/s]Consolidating:  37%|███▋      | 51/138 [00:13<00:23,  3.74chunk/s]Consolidating:  38%|███▊      | 52/138 [00:13<00:22,  3.75chunk/s]Consolidating:  38%|███▊      | 53/138 [00:13<00:22,  3.76chunk/s]Consolidating:  39%|███▉      | 54/138 [00:14<00:22,  3.79chunk/s]Consolidating:  40%|███▉      | 55/138 [00:14<00:22,  3.77chunk/s]Consolidating:  41%|████      | 56/138 [00:14<00:21,  3.78chunk/s]Consolidating:  41%|████▏     | 57/138 [00:14<00:21,  3.79chunk/s]Consolidating:  42%|████▏     | 58/138 [00:15<00:21,  3.78chunk/s]Consolidating:  43%|████▎     | 59/138 [00:15<00:20,  3.78chunk/s]Consolidating:  43%|████▎     | 60/138 [00:15<00:20,  3.78chunk/s]Consolidating:  44%|████▍     | 61/138 [00:16<00:20,  3.76chunk/s]Consolidating:  45%|████▍     | 62/138 [00:16<00:20,  3.74chunk/s]Consolidating:  46%|████▌     | 63/138 [00:16<00:19,  3.76chunk/s]Consolidating:  46%|████▋     | 64/138 [00:16<00:19,  3.78chunk/s]Consolidating:  47%|████▋     | 65/138 [00:17<00:27,  2.61chunk/s]Consolidating:  48%|████▊     | 66/138 [00:17<00:24,  2.88chunk/s]Consolidating:  49%|████▊     | 67/138 [00:18<00:22,  3.12chunk/s]Consolidating:  49%|████▉     | 68/138 [00:18<00:21,  3.30chunk/s]Consolidating:  50%|█████     | 69/138 [00:18<00:19,  3.47chunk/s]Consolidating:  51%|█████     | 70/138 [00:18<00:18,  3.58chunk/s]Consolidating:  51%|█████▏    | 71/138 [00:19<00:18,  3.66chunk/s]Consolidating:  52%|█████▏    | 72/138 [00:19<00:17,  3.71chunk/s]Consolidating:  53%|█████▎    | 73/138 [00:19<00:17,  3.75chunk/s]Consolidating:  54%|█████▎    | 74/138 [00:19<00:16,  3.79chunk/s]Consolidating:  54%|█████▍    | 75/138 [00:20<00:16,  3.81chunk/s]Consolidating:  55%|█████▌    | 76/138 [00:20<00:16,  3.82chunk/s]Consolidating:  56%|█████▌    | 77/138 [00:20<00:15,  3.82chunk/s]Consolidating:  57%|█████▋    | 78/138 [00:20<00:15,  3.84chunk/s]Consolidating:  57%|█████▋    | 79/138 [00:21<00:15,  3.83chunk/s]Consolidating:  58%|█████▊    | 80/138 [00:21<00:15,  3.82chunk/s]Consolidating:  59%|█████▊    | 81/138 [00:21<00:14,  3.82chunk/s]Consolidating:  59%|█████▉    | 82/138 [00:21<00:14,  3.82chunk/s]Consolidating:  60%|██████    | 83/138 [00:22<00:14,  3.82chunk/s]Consolidating:  61%|██████    | 84/138 [00:22<00:14,  3.81chunk/s]Consolidating:  62%|██████▏   | 85/138 [00:22<00:13,  3.80chunk/s]Consolidating:  62%|██████▏   | 86/138 [00:22<00:13,  3.79chunk/s]Consolidating:  63%|██████▎   | 87/138 [00:23<00:13,  3.80chunk/s]Consolidating:  64%|██████▍   | 88/138 [00:23<00:13,  3.77chunk/s]Consolidating:  64%|██████▍   | 89/138 [00:23<00:12,  3.78chunk/s]Consolidating:  65%|██████▌   | 90/138 [00:24<00:12,  3.80chunk/s]Consolidating:  66%|██████▌   | 91/138 [00:24<00:12,  3.80chunk/s]Consolidating:  67%|██████▋   | 92/138 [00:24<00:12,  3.80chunk/s]Consolidating:  67%|██████▋   | 93/138 [00:24<00:11,  3.80chunk/s]Consolidating:  68%|██████▊   | 94/138 [00:25<00:11,  3.81chunk/s]Consolidating:  69%|██████▉   | 95/138 [00:25<00:11,  3.78chunk/s]Consolidating:  70%|██████▉   | 96/138 [00:25<00:11,  3.79chunk/s]Consolidating:  70%|███████   | 97/138 [00:25<00:10,  3.76chunk/s]Consolidating:  71%|███████   | 98/138 [00:26<00:10,  3.78chunk/s]Consolidating:  72%|███████▏  | 99/138 [00:26<00:10,  3.79chunk/s]Consolidating:  72%|███████▏  | 100/138 [00:26<00:10,  3.77chunk/s]Consolidating:  73%|███████▎  | 101/138 [00:26<00:09,  3.76chunk/s]Consolidating:  74%|███████▍  | 102/138 [00:27<00:09,  3.74chunk/s]Consolidating:  75%|███████▍  | 103/138 [00:27<00:09,  3.75chunk/s]Consolidating:  75%|███████▌  | 104/138 [00:27<00:09,  3.76chunk/s]Consolidating:  76%|███████▌  | 105/138 [00:28<00:08,  3.77chunk/s]Consolidating:  77%|███████▋  | 106/138 [00:28<00:08,  3.77chunk/s]Consolidating:  78%|███████▊  | 107/138 [00:28<00:08,  3.78chunk/s]Consolidating:  78%|███████▊  | 108/138 [00:28<00:07,  3.78chunk/s]Consolidating:  79%|███████▉  | 109/138 [00:29<00:07,  3.76chunk/s]Consolidating:  80%|███████▉  | 110/138 [00:29<00:07,  3.76chunk/s]Consolidating:  80%|████████  | 111/138 [00:29<00:07,  3.77chunk/s]Consolidating:  81%|████████  | 112/138 [00:29<00:06,  3.78chunk/s]Consolidating:  82%|████████▏ | 113/138 [00:30<00:06,  3.78chunk/s]Consolidating:  83%|████████▎ | 114/138 [00:30<00:07,  3.26chunk/s]Consolidating:  83%|████████▎ | 115/138 [01:00<03:31,  9.21s/chunk]Consolidating:  84%|████████▍ | 116/138 [01:00<02:23,  6.53s/chunk]Consolidating:  85%|████████▍ | 117/138 [01:01<01:37,  4.65s/chunk]Consolidating:  86%|████████▌ | 118/138 [01:01<01:06,  3.33s/chunk]Consolidating:  86%|████████▌ | 119/138 [01:01<00:46,  2.42s/chunk]Consolidating:  87%|████████▋ | 120/138 [01:03<00:38,  2.16s/chunk]Consolidating:  88%|████████▊ | 121/138 [01:03<00:26,  1.59s/chunk]Consolidating:  88%|████████▊ | 122/138 [01:03<00:19,  1.19s/chunk]Consolidating:  89%|████████▉ | 123/138 [01:03<00:13,  1.08chunk/s]Consolidating:  90%|████████▉ | 124/138 [01:04<00:10,  1.38chunk/s]Consolidating:  91%|█████████ | 125/138 [01:04<00:07,  1.71chunk/s]Consolidating:  91%|█████████▏| 126/138 [01:04<00:05,  2.04chunk/s]Consolidating:  92%|█████████▏| 127/138 [01:05<00:04,  2.37chunk/s]Consolidating:  93%|█████████▎| 128/138 [01:05<00:03,  2.67chunk/s]Consolidating:  93%|█████████▎| 129/138 [01:05<00:03,  2.93chunk/s]Consolidating:  94%|█████████▍| 130/138 [01:05<00:02,  3.14chunk/s]Consolidating:  95%|█████████▍| 131/138 [01:06<00:02,  3.30chunk/s]Consolidating:  96%|█████████▌| 132/138 [01:06<00:01,  3.42chunk/s]Consolidating:  96%|█████████▋| 133/138 [01:06<00:01,  3.52chunk/s]Consolidating:  97%|█████████▋| 134/138 [01:06<00:01,  3.58chunk/s]Consolidating:  98%|█████████▊| 135/138 [01:07<00:00,  3.63chunk/s]Consolidating:  99%|█████████▊| 136/138 [01:07<00:00,  3.66chunk/s]Consolidating:  99%|█████████▉| 137/138 [01:07<00:00,  3.68chunk/s]Consolidating: 100%|██████████| 138/138 [01:07<00:00,  4.02chunk/s]Consolidating: 100%|██████████| 138/138 [01:07<00:00,  2.03chunk/s]
[After consolidation] CPU: 2.66GB
[mmap] Consolidated 687,550 embeddings to cluster_out_v6_astrobert/consolidated_embeddings.dat
[mmap] Loaded embeddings shape: (687550, 768)
[umap] dim=50 n_neighbors=50
CUML not available, falling back to CPU UMAP
[Before CPU UMAP] CPU: 0.69GB
[CPU-UMAP] Attempting to load 687,550 points into memory
UMAP(angular_rp_forest=True, metric='cosine', min_dist=0.05, n_components=50, n_neighbors=50, random_state=42, verbose=True)
Sun Sep  7 15:44:35 2025 Construct fuzzy simplicial set
Sun Sep  7 15:44:36 2025 Finding Nearest Neighbors
Sun Sep  7 15:44:36 2025 Building RP forest with 46 trees
Sun Sep  7 15:45:14 2025 NN descent for 19 iterations
	 1  /  19
	 2  /  19
	 3  /  19
	Stopping threshold met -- exiting after 3 iterations
Sun Sep  7 15:47:55 2025 Finished Nearest Neighbor Search
Sun Sep  7 15:48:08 2025 Construct embedding
Epochs completed:   0%|            0/200 [00:00]Epochs completed:   0%|            1/200 [00:00]Epochs completed:   1%|            2/200 [00:01]Epochs completed:   2%| ▏          3/200 [00:06]Epochs completed:   2%| ▏          4/200 [00:12]Epochs completed:   2%| ▎          5/200 [00:18]Epochs completed:   3%| ▎          6/200 [00:25]Epochs completed:   4%| ▎          7/200 [00:32]Epochs completed:   4%| ▍          8/200 [00:39]Epochs completed:   4%| ▍          9/200 [00:47]Epochs completed:   5%| ▌          10/200 [00:56]Epochs completed:   6%| ▌          11/200 [01:04]Epochs completed:   6%| ▌          12/200 [01:13]Epochs completed:   6%| ▋          13/200 [01:22]Epochs completed:   7%| ▋          14/200 [01:31]Epochs completed:   8%| ▊          15/200 [01:40]Epochs completed:   8%| ▊          16/200 [01:50]Epochs completed:   8%| ▊          17/200 [01:59]Epochs completed:   9%| ▉          18/200 [02:09]Epochs completed:  10%| ▉          19/200 [02:18]Epochs completed:  10%| █          20/200 [02:28]Epochs completed:  10%| █          21/200 [02:38]Epochs completed:  11%| █          22/200 [02:47]Epochs completed:  12%| █▏         23/200 [02:57]Epochs completed:  12%| █▏         24/200 [03:07]Epochs completed:  12%| █▎         25/200 [03:17]Epochs completed:  13%| █▎         26/200 [03:26]Epochs completed:  14%| █▎         27/200 [03:36]Epochs completed:  14%| █▍         28/200 [03:46]Epochs completed:  14%| █▍         29/200 [03:56]Epochs completed:  15%| █▌         30/200 [04:06]Epochs completed:  16%| █▌         31/200 [04:16]Epochs completed:  16%| █▌         32/200 [04:25]Epochs completed:  16%| █▋         33/200 [04:35]Epochs completed:  17%| █▋         34/200 [04:45]Epochs completed:  18%| █▊         35/200 [04:55]Epochs completed:  18%| █▊         36/200 [05:05]Epochs completed:  18%| █▊         37/200 [05:15]Epochs completed:  19%| █▉         38/200 [05:25]Epochs completed:  20%| █▉         39/200 [05:35]Epochs completed:  20%| ██         40/200 [05:45]Epochs completed:  20%| ██         41/200 [05:55]Epochs completed:  21%| ██         42/200 [06:05]Epochs completed:  22%| ██▏        43/200 [06:15]Epochs completed:  22%| ██▏        44/200 [06:25]Epochs completed:  22%| ██▎        45/200 [06:34]Epochs completed:  23%| ██▎        46/200 [06:44]Epochs completed:  24%| ██▎        47/200 [06:54]Epochs completed:  24%| ██▍        48/200 [07:04]Epochs completed:  24%| ██▍        49/200 [07:14]Epochs completed:  25%| ██▌        50/200 [07:24]Epochs completed:  26%| ██▌        51/200 [07:34]Epochs completed:  26%| ██▌        52/200 [07:44]Epochs completed:  26%| ██▋        53/200 [07:54]Epochs completed:  27%| ██▋        54/200 [08:04]Epochs completed:  28%| ██▊        55/200 [08:14]Epochs completed:  28%| ██▊        56/200 [08:24]Epochs completed:  28%| ██▊        57/200 [08:34]Epochs completed:  29%| ██▉        58/200 [08:44]Epochs completed:  30%| ██▉        59/200 [08:54]Epochs completed:  30%| ███        60/200 [09:04]Epochs completed:  30%| ███        61/200 [09:14]Epochs completed:  31%| ███        62/200 [09:24]Epochs completed:  32%| ███▏       63/200 [09:34]Epochs completed:  32%| ███▏       64/200 [09:44]Epochs completed:  32%| ███▎       65/200 [09:54]Epochs completed:  33%| ███▎       66/200 [10:04]Epochs completed:  34%| ███▎       67/200 [10:14]Epochs completed:  34%| ███▍       68/200 [10:24]Epochs completed:  34%| ███▍       69/200 [10:34]Epochs completed:  35%| ███▌       70/200 [10:44]Epochs completed:  36%| ███▌       71/200 [10:54]Epochs completed:  36%| ███▌       72/200 [11:04]Epochs completed:  36%| ███▋       73/200 [11:14]Epochs completed:  37%| ███▋       74/200 [11:24]Epochs completed:  38%| ███▊       75/200 [11:34]Epochs completed:  38%| ███▊       76/200 [11:44]Epochs completed:  38%| ███▊       77/200 [11:54]Epochs completed:  39%| ███▉       78/200 [12:04]Epochs completed:  40%| ███▉       79/200 [12:14]Epochs completed:  40%| ████       80/200 [12:24]Epochs completed:  40%| ████       81/200 [12:34]Epochs completed:  41%| ████       82/200 [12:44]Epochs completed:  42%| ████▏      83/200 [12:54]Epochs completed:  42%| ████▏      84/200 [13:04]Epochs completed:  42%| ████▎      85/200 [13:13]Epochs completed:  43%| ████▎      86/200 [13:23]Epochs completed:  44%| ████▎      87/200 [13:33]Epochs completed:  44%| ████▍      88/200 [13:43]Epochs completed:  44%| ████▍      89/200 [13:53]Epochs completed:  45%| ████▌      90/200 [14:03]Epochs completed:  46%| ████▌      91/200 [14:14]Epochs completed:  46%| ████▌      92/200 [14:24]Epochs completed:  46%| ████▋      93/200 [14:34]Epochs completed:  47%| ████▋      94/200 [14:44]Epochs completed:  48%| ████▊      95/200 [14:54]Epochs completed:  48%| ████▊      96/200 [15:04]Epochs completed:  48%| ████▊      97/200 [15:14]Epochs completed:  49%| ████▉      98/200 [15:24]Epochs completed:  50%| ████▉      99/200 [15:34]Epochs completed:  50%| █████      100/200 [15:44]Epochs completed:  50%| █████      101/200 [15:54]Epochs completed:  51%| █████      102/200 [16:04]Epochs completed:  52%| █████▏     103/200 [16:14]Epochs completed:  52%| █████▏     104/200 [16:24]Epochs completed:  52%| █████▎     105/200 [16:34]Epochs completed:  53%| █████▎     106/200 [16:44]Epochs completed:  54%| █████▎     107/200 [16:54]Epochs completed:  54%| █████▍     108/200 [17:04]Epochs completed:  55%| █████▍     109/200 [17:14]Epochs completed:  55%| █████▌     110/200 [17:24]Epochs completed:  56%| █████▌     111/200 [17:34]Epochs completed:  56%| █████▌     112/200 [17:44]Epochs completed:  56%| █████▋     113/200 [17:54]Epochs completed:  57%| █████▋     114/200 [18:04]Epochs completed:  57%| █████▊     115/200 [18:14]Epochs completed:  58%| █████▊     116/200 [18:24]Epochs completed:  58%| █████▊     117/200 [18:34]Epochs completed:  59%| █████▉     118/200 [18:44]Epochs completed:  60%| █████▉     119/200 [18:54]Epochs completed:  60%| ██████     120/200 [19:04]Epochs completed:  60%| ██████     121/200 [19:14]Epochs completed:  61%| ██████     122/200 [19:24]Epochs completed:  62%| ██████▏    123/200 [19:34]Epochs completed:  62%| ██████▏    124/200 [19:44]Epochs completed:  62%| ██████▎    125/200 [19:54]Epochs completed:  63%| ██████▎    126/200 [20:04]Epochs completed:  64%| ██████▎    127/200 [20:14]Epochs completed:  64%| ██████▍    128/200 [20:24]Epochs completed:  64%| ██████▍    129/200 [20:34]Epochs completed:  65%| ██████▌    130/200 [20:44]Epochs completed:  66%| ██████▌    131/200 [20:54]Epochs completed:  66%| ██████▌    132/200 [21:04]Epochs completed:  66%| ██████▋    133/200 [21:14]Epochs completed:  67%| ██████▋    134/200 [21:24]Epochs completed:  68%| ██████▊    135/200 [21:34]Epochs completed:  68%| ██████▊    136/200 [21:44]Epochs completed:  68%| ██████▊    137/200 [21:54]Epochs completed:  69%| ██████▉    138/200 [22:04]Epochs completed:  70%| ██████▉    139/200 [22:14]Epochs completed:  70%| ███████    140/200 [22:24]Epochs completed:  70%| ███████    141/200 [22:34]Epochs completed:  71%| ███████    142/200 [22:44]Epochs completed:  72%| ███████▏   143/200 [22:54]Epochs completed:  72%| ███████▏   144/200 [23:04]Epochs completed:  72%| ███████▎   145/200 [23:14]Epochs completed:  73%| ███████▎   146/200 [23:24]Epochs completed:  74%| ███████▎   147/200 [23:34]Epochs completed:  74%| ███████▍   148/200 [23:44]Epochs completed:  74%| ███████▍   149/200 [23:54]Epochs completed:  75%| ███████▌   150/200 [24:04]Epochs completed:  76%| ███████▌   151/200 [24:14]Epochs completed:  76%| ███████▌   152/200 [24:24]Epochs completed:  76%| ███████▋   153/200 [24:34]Epochs completed:  77%| ███████▋   154/200 [24:44]Epochs completed:  78%| ███████▊   155/200 [24:54]Epochs completed:  78%| ███████▊   156/200 [25:04]Epochs completed:  78%| ███████▊   157/200 [25:14]Epochs completed:  79%| ███████▉   158/200 [25:24]Epochs completed:  80%| ███████▉   159/200 [25:34]Epochs completed:  80%| ████████   160/200 [25:44]Epochs completed:  80%| ████████   161/200 [25:54]Epochs completed:  81%| ████████   162/200 [26:04]Epochs completed:  82%| ████████▏  163/200 [26:14]Epochs completed:  82%| ████████▏  164/200 [26:24]Epochs completed:  82%| ████████▎  165/200 [26:34]Epochs completed:  83%| ████████▎  166/200 [26:44]Epochs completed:  84%| ████████▎  167/200 [26:54]Epochs completed:  84%| ████████▍  168/200 [27:04]Epochs completed:  84%| ████████▍  169/200 [27:14]Epochs completed:  85%| ████████▌  170/200 [27:24]Epochs completed:  86%| ████████▌  171/200 [27:34]Epochs completed:  86%| ████████▌  172/200 [27:44]Epochs completed:  86%| ████████▋  173/200 [27:54]Epochs completed:  87%| ████████▋  174/200 [28:04]Epochs completed:  88%| ████████▊  175/200 [28:14]Epochs completed:  88%| ████████▊  176/200 [28:24]Epochs completed:  88%| ████████▊  177/200 [28:34]Epochs completed:  89%| ████████▉  178/200 [28:44]Epochs completed:  90%| ████████▉  179/200 [28:54]Epochs completed:  90%| █████████  180/200 [29:04]Epochs completed:  90%| █████████  181/200 [29:14]Epochs completed:  91%| █████████  182/200 [29:24]Epochs completed:  92%| █████████▏ 183/200 [29:34]Epochs completed:  92%| █████████▏ 184/200 [29:44]Epochs completed:  92%| █████████▎ 185/200 [29:54]Epochs completed:  93%| █████████▎ 186/200 [30:04]Epochs completed:  94%| █████████▎ 187/200 [30:14]Epochs completed:  94%| █████████▍ 188/200 [30:24]Epochs completed:  94%| █████████▍ 189/200 [30:34]Epochs completed:  95%| █████████▌ 190/200 [30:44]Epochs completed:  96%| █████████▌ 191/200 [30:54]Epochs completed:  96%| █████████▌ 192/200 [31:04]Epochs completed:  96%| █████████▋ 193/200 [31:14]Epochs completed:  97%| █████████▋ 194/200 [31:24]Epochs completed:  98%| █████████▊ 195/200 [31:34]Epochs completed:  98%| █████████▊ 196/200 [31:44]Epochs completed:  98%| █████████▊ 197/200 [31:54]Epochs completed:  99%| █████████▉ 198/200 [32:04]Epochs completed: 100%| █████████▉ 199/200 [32:14]Epochs completed: 100%| ██████████ 200/200 [32:24]Epochs completed: 100%| ██████████ 200/200 [32:24]
Sun Sep  7 16:29:10 2025 Finished embedding
[After CPU UMAP] CPU: 11.01GB
[hdbscan] metric=euclidean min_cluster_size=500
CUML not available, falling back to CPU HDBSCAN
[Before CPU HDBSCAN] CPU: 3.73GB
[CPU-HDBSCAN] Clustering 687,550 points with metric=euclidean
[After CPU HDBSCAN] CPU: 3.78GB

============================================================
CLUSTERING RESULTS
============================================================
{
  "paragraphs": 687550,
  "clusters": 108,
  "noise": 416039,
  "noise_pct": 60.51,
  "avg_cluster_size": 2513.99,
  "median_cluster_size": 1306,
  "min_cluster_size": 504,
  "max_cluster_size": 22134
}
============================================================

[write] Labels saved to: cluster_out_v6_astrobert/labels_paragraph.csv
[write] Summary saved to: cluster_out_v6_astrobert/cluster_summary.json
[write] Config saved to: cluster_out_v6_astrobert/cluster_config.json
[Script end] CPU: 3.78GB

✓ Memory-optimized clustering completed successfully!
