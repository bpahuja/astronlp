/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[Script start] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
[GPU] GPU Available: True
[GPU] CUML Available: True
[GPU] Device 0: NVIDIA A16 (14.6GB)
[scan] Using 138 shard folders
[Before loading data] CPU: 0.60GB | GPU: 0.00GB used / 0.00GB total
Counting rows:   0%|          | 0/138 [00:00<?, ?chunk/s]Counting rows:   2%|▏         | 3/138 [00:00<00:05, 26.49chunk/s]Counting rows:   4%|▍         | 6/138 [00:00<00:04, 27.15chunk/s]Counting rows:   7%|▋         | 9/138 [00:00<00:04, 27.42chunk/s]Counting rows:   9%|▉         | 13/138 [00:00<00:04, 28.88chunk/s]Counting rows:  12%|█▏        | 16/138 [00:00<00:04, 25.87chunk/s]Counting rows:  14%|█▍        | 19/138 [00:00<00:04, 26.98chunk/s]Counting rows:  16%|█▌        | 22/138 [00:00<00:04, 27.86chunk/s]Counting rows:  18%|█▊        | 25/138 [00:00<00:04, 28.12chunk/s]Counting rows:  20%|██        | 28/138 [00:01<00:03, 27.70chunk/s]Counting rows:  22%|██▏       | 31/138 [00:01<00:04, 26.35chunk/s]Counting rows:  25%|██▍       | 34/138 [00:01<00:04, 25.46chunk/s]Counting rows:  27%|██▋       | 37/138 [00:01<00:04, 24.90chunk/s]Counting rows:  29%|██▉       | 40/138 [00:01<00:04, 24.46chunk/s]Counting rows:  31%|███       | 43/138 [00:01<00:03, 24.68chunk/s]Counting rows:  33%|███▎      | 46/138 [00:01<00:03, 24.79chunk/s]Counting rows:  36%|███▌      | 49/138 [00:01<00:03, 24.10chunk/s]Counting rows:  38%|███▊      | 52/138 [00:02<00:03, 23.56chunk/s]Counting rows:  40%|███▉      | 55/138 [00:02<00:03, 23.78chunk/s]Counting rows:  42%|████▏     | 58/138 [00:02<00:03, 23.41chunk/s]Counting rows:  44%|████▍     | 61/138 [00:02<00:03, 21.44chunk/s]Counting rows:  46%|████▋     | 64/138 [00:02<00:03, 21.59chunk/s]Counting rows:  49%|████▊     | 67/138 [00:02<00:03, 21.30chunk/s]Counting rows:  51%|█████     | 70/138 [00:02<00:03, 20.82chunk/s]Counting rows:  53%|█████▎    | 73/138 [00:03<00:03, 19.87chunk/s]Counting rows:  55%|█████▌    | 76/138 [00:03<00:03, 16.45chunk/s]Counting rows:  57%|█████▋    | 78/138 [00:03<00:04, 14.59chunk/s]Counting rows:  58%|█████▊    | 80/138 [00:03<00:03, 15.03chunk/s]Counting rows:  59%|█████▉    | 82/138 [00:04<00:07,  7.34chunk/s]Counting rows:  61%|██████    | 84/138 [00:04<00:09,  5.58chunk/s]Counting rows:  63%|██████▎   | 87/138 [00:05<00:06,  7.79chunk/s]Counting rows:  65%|██████▌   | 90/138 [00:05<00:04, 10.43chunk/s]Counting rows:  67%|██████▋   | 93/138 [00:05<00:03, 13.24chunk/s]Counting rows:  70%|███████   | 97/138 [00:05<00:02, 16.91chunk/s]Counting rows:  72%|███████▏  | 100/138 [00:05<00:01, 19.35chunk/s]Counting rows:  75%|███████▍  | 103/138 [00:05<00:01, 21.40chunk/s]Counting rows:  77%|███████▋  | 106/138 [00:05<00:01, 23.23chunk/s]Counting rows:  79%|███████▉  | 109/138 [00:05<00:01, 24.40chunk/s]Counting rows:  81%|████████  | 112/138 [00:05<00:01, 24.52chunk/s]Counting rows:  83%|████████▎ | 115/138 [00:06<00:00, 23.99chunk/s]Counting rows:  86%|████████▌ | 118/138 [00:06<00:00, 25.18chunk/s]Counting rows:  88%|████████▊ | 121/138 [00:06<00:00, 26.06chunk/s]Counting rows:  90%|████████▉ | 124/138 [00:06<00:00, 26.78chunk/s]Counting rows:  92%|█████████▏| 127/138 [00:06<00:00, 21.86chunk/s]Counting rows:  94%|█████████▍| 130/138 [00:06<00:00, 23.53chunk/s]Counting rows:  96%|█████████▋| 133/138 [00:06<00:00, 24.86chunk/s]Counting rows:  99%|█████████▊| 136/138 [00:06<00:00, 25.80chunk/s]Counting rows: 100%|██████████| 138/138 [00:06<00:00, 19.99chunk/s]
[load] Total paragraphs (after sampling): 1,375,099, dim=768
[load] Estimated memory for embeddings: 3.93GB
Loading shards:   0%|          | 0/138 [00:00<?, ?chunk/s]Loading shards:   1%|          | 1/138 [00:00<00:51,  2.68chunk/s]Loading shards:   1%|▏         | 2/138 [00:00<00:52,  2.59chunk/s]Loading shards:   2%|▏         | 3/138 [00:00<00:42,  3.18chunk/s]Loading shards:   3%|▎         | 4/138 [00:01<00:48,  2.74chunk/s]Loading shards:   4%|▎         | 5/138 [00:01<00:47,  2.77chunk/s]Loading shards:   4%|▍         | 6/138 [00:02<00:49,  2.65chunk/s]Loading shards:   5%|▌         | 7/138 [00:02<00:52,  2.49chunk/s]Loading shards:   6%|▌         | 8/138 [00:02<00:44,  2.89chunk/s]Loading shards:   7%|▋         | 9/138 [00:03<00:39,  3.24chunk/s]Loading shards:   7%|▋         | 10/138 [00:03<00:44,  2.88chunk/s]Loading shards:   8%|▊         | 11/138 [00:03<00:40,  3.17chunk/s]Loading shards:   9%|▊         | 12/138 [00:04<00:55,  2.26chunk/s]Loading shards:   9%|▉         | 13/138 [00:04<00:47,  2.61chunk/s]Loading shards:  10%|█         | 14/138 [00:05<00:43,  2.84chunk/s]Loading shards:  11%|█         | 15/138 [00:05<00:38,  3.18chunk/s]Loading shards:  12%|█▏        | 16/138 [00:05<00:46,  2.61chunk/s]Loading shards:  12%|█▏        | 17/138 [00:06<00:57,  2.12chunk/s]Loading shards:  13%|█▎        | 18/138 [00:06<00:47,  2.51chunk/s]Loading shards:  14%|█▍        | 19/138 [00:06<00:42,  2.78chunk/s]Loading shards:  14%|█▍        | 20/138 [00:07<00:37,  3.11chunk/s]Loading shards:  15%|█▌        | 21/138 [00:08<00:54,  2.14chunk/s]Loading shards:  16%|█▌        | 22/138 [00:11<02:44,  1.42s/chunk]Loading shards:  17%|█▋        | 23/138 [00:11<02:02,  1.07s/chunk]Loading shards:  17%|█▋        | 24/138 [00:12<01:33,  1.23chunk/s]Loading shards:  18%|█▊        | 25/138 [00:14<02:35,  1.38s/chunk]Loading shards:  19%|█▉        | 26/138 [00:15<02:01,  1.08s/chunk]Loading shards:  20%|█▉        | 27/138 [00:16<02:08,  1.16s/chunk]Loading shards:  20%|██        | 28/138 [00:18<02:22,  1.29s/chunk]Loading shards:  21%|██        | 29/138 [00:18<01:46,  1.02chunk/s]Loading shards:  22%|██▏       | 30/138 [00:18<01:21,  1.33chunk/s]Loading shards:  22%|██▏       | 31/138 [00:18<01:04,  1.67chunk/s]Loading shards:  23%|██▎       | 32/138 [00:19<01:02,  1.70chunk/s]Loading shards:  24%|██▍       | 33/138 [00:19<00:50,  2.07chunk/s]Loading shards:  25%|██▍       | 34/138 [00:20<00:56,  1.86chunk/s]Loading shards:  25%|██▌       | 35/138 [00:21<01:02,  1.64chunk/s]Loading shards:  26%|██▌       | 36/138 [00:21<01:03,  1.61chunk/s]Loading shards:  27%|██▋       | 37/138 [00:22<01:15,  1.34chunk/s]Loading shards:  28%|██▊       | 38/138 [00:23<01:02,  1.59chunk/s]Loading shards:  28%|██▊       | 39/138 [00:23<00:51,  1.94chunk/s]Loading shards:  29%|██▉       | 40/138 [00:23<00:42,  2.32chunk/s]Loading shards:  30%|██▉       | 41/138 [00:24<00:44,  2.20chunk/s]Loading shards:  30%|███       | 42/138 [00:24<00:37,  2.58chunk/s]Loading shards:  31%|███       | 43/138 [00:24<00:38,  2.46chunk/s]Loading shards:  32%|███▏      | 44/138 [00:25<00:49,  1.89chunk/s]Loading shards:  33%|███▎      | 45/138 [00:25<00:41,  2.25chunk/s]Loading shards:  33%|███▎      | 46/138 [00:26<00:39,  2.34chunk/s]Loading shards:  34%|███▍      | 47/138 [00:26<00:40,  2.24chunk/s]Loading shards:  35%|███▍      | 48/138 [00:27<00:34,  2.59chunk/s]Loading shards:  36%|███▌      | 49/138 [00:27<00:31,  2.79chunk/s]Loading shards:  36%|███▌      | 50/138 [00:27<00:31,  2.81chunk/s]Loading shards:  37%|███▋      | 51/138 [00:28<00:34,  2.49chunk/s]Loading shards:  38%|███▊      | 52/138 [00:28<00:36,  2.36chunk/s]Loading shards:  38%|███▊      | 53/138 [00:29<00:42,  1.98chunk/s]Loading shards:  39%|███▉      | 54/138 [00:29<00:41,  2.04chunk/s]Loading shards:  40%|███▉      | 55/138 [00:31<00:59,  1.40chunk/s]Loading shards:  41%|████      | 56/138 [00:33<01:48,  1.33s/chunk]Loading shards:  41%|████▏     | 57/138 [00:35<01:44,  1.30s/chunk]Loading shards:  42%|████▏     | 58/138 [00:36<01:59,  1.49s/chunk]Loading shards:  43%|████▎     | 59/138 [00:37<01:28,  1.11s/chunk]Loading shards:  43%|████▎     | 60/138 [00:37<01:16,  1.02chunk/s]Loading shards:  44%|████▍     | 61/138 [00:38<01:04,  1.20chunk/s]Loading shards:  45%|████▍     | 62/138 [00:39<01:12,  1.05chunk/s]Loading shards:  46%|████▌     | 63/138 [00:39<00:55,  1.35chunk/s]Loading shards:  46%|████▋     | 64/138 [00:40<00:49,  1.49chunk/s]Loading shards:  47%|████▋     | 65/138 [00:40<00:39,  1.85chunk/s]Loading shards:  48%|████▊     | 66/138 [00:42<01:08,  1.05chunk/s]Loading shards:  49%|████▊     | 67/138 [00:42<00:52,  1.36chunk/s]Loading shards:  49%|████▉     | 68/138 [00:45<01:36,  1.37s/chunk]Loading shards:  50%|█████     | 69/138 [00:45<01:12,  1.05s/chunk]Loading shards:  51%|█████     | 70/138 [00:46<00:55,  1.23chunk/s]Loading shards:  51%|█████▏    | 71/138 [00:47<01:08,  1.02s/chunk]Loading shards:  52%|█████▏    | 72/138 [00:47<00:53,  1.24chunk/s]Loading shards:  53%|█████▎    | 73/138 [00:48<00:41,  1.57chunk/s]Loading shards:  54%|█████▎    | 74/138 [00:48<00:34,  1.88chunk/s]Loading shards:  54%|█████▍    | 75/138 [00:48<00:28,  2.25chunk/s]Loading shards:  55%|█████▌    | 76/138 [00:49<00:33,  1.86chunk/s]Loading shards:  56%|█████▌    | 77/138 [00:49<00:27,  2.23chunk/s]Loading shards:  57%|█████▋    | 78/138 [00:50<00:27,  2.15chunk/s]Loading shards:  57%|█████▋    | 79/138 [00:50<00:30,  1.94chunk/s]Loading shards:  58%|█████▊    | 80/138 [00:51<00:25,  2.30chunk/s]Loading shards:  59%|█████▊    | 81/138 [00:51<00:21,  2.61chunk/s]Loading shards:  59%|█████▉    | 82/138 [00:51<00:23,  2.36chunk/s]Loading shards:  60%|██████    | 83/138 [00:52<00:32,  1.67chunk/s]Loading shards:  61%|██████    | 84/138 [00:53<00:26,  2.03chunk/s]Loading shards:  62%|██████▏   | 85/138 [00:53<00:22,  2.39chunk/s]Loading shards:  62%|██████▏   | 86/138 [00:53<00:24,  2.15chunk/s]Loading shards:  63%|██████▎   | 87/138 [00:54<00:26,  1.89chunk/s]Loading shards:  64%|██████▍   | 88/138 [00:55<00:26,  1.86chunk/s]Loading shards:  64%|██████▍   | 89/138 [00:55<00:21,  2.24chunk/s]Loading shards:  65%|██████▌   | 90/138 [00:56<00:25,  1.90chunk/s]Loading shards:  66%|██████▌   | 91/138 [00:56<00:22,  2.06chunk/s]Loading shards:  67%|██████▋   | 92/138 [00:56<00:21,  2.13chunk/s]Loading shards:  67%|██████▋   | 93/138 [00:57<00:18,  2.42chunk/s]Loading shards:  68%|██████▊   | 94/138 [00:58<00:33,  1.30chunk/s]Loading shards:  69%|██████▉   | 95/138 [00:59<00:26,  1.64chunk/s]Loading shards:  70%|██████▉   | 96/138 [00:59<00:21,  1.97chunk/s]Loading shards:  70%|███████   | 97/138 [00:59<00:19,  2.14chunk/s]Loading shards:  71%|███████   | 98/138 [01:01<00:39,  1.02chunk/s]Loading shards:  72%|███████▏  | 99/138 [01:03<00:44,  1.15s/chunk]Loading shards:  72%|███████▏  | 100/138 [01:05<00:52,  1.38s/chunk]Loading shards:  73%|███████▎  | 101/138 [01:06<00:52,  1.41s/chunk]Loading shards:  74%|███████▍  | 102/138 [01:07<00:38,  1.06s/chunk]Loading shards:  75%|███████▍  | 103/138 [01:08<00:40,  1.15s/chunk]Loading shards:  75%|███████▌  | 104/138 [01:08<00:31,  1.09chunk/s]Loading shards:  76%|███████▌  | 105/138 [01:09<00:23,  1.40chunk/s]Loading shards:  77%|███████▋  | 106/138 [01:09<00:18,  1.74chunk/s]Loading shards:  78%|███████▊  | 107/138 [01:09<00:14,  2.10chunk/s]Loading shards:  78%|███████▊  | 108/138 [01:09<00:12,  2.40chunk/s]Loading shards:  79%|███████▉  | 109/138 [01:10<00:12,  2.24chunk/s]Loading shards:  80%|███████▉  | 110/138 [01:11<00:16,  1.68chunk/s]Loading shards:  80%|████████  | 111/138 [01:11<00:13,  2.04chunk/s]Loading shards:  81%|████████  | 112/138 [01:11<00:11,  2.32chunk/s]Loading shards:  82%|████████▏ | 113/138 [01:12<00:10,  2.28chunk/s]Loading shards:  83%|████████▎ | 114/138 [01:12<00:09,  2.48chunk/s]Loading shards:  83%|████████▎ | 115/138 [01:12<00:08,  2.82chunk/s]Loading shards:  84%|████████▍ | 116/138 [01:14<00:18,  1.18chunk/s]Loading shards:  85%|████████▍ | 117/138 [01:15<00:14,  1.50chunk/s]Loading shards:  86%|████████▌ | 118/138 [01:15<00:11,  1.70chunk/s]Loading shards:  86%|████████▌ | 119/138 [01:16<00:10,  1.75chunk/s]Loading shards:  87%|████████▋ | 120/138 [01:16<00:09,  1.86chunk/s]Loading shards:  88%|████████▊ | 121/138 [01:17<00:10,  1.68chunk/s]Loading shards:  88%|████████▊ | 122/138 [01:17<00:07,  2.04chunk/s]Loading shards:  89%|████████▉ | 123/138 [01:18<00:08,  1.87chunk/s]Loading shards:  90%|████████▉ | 124/138 [01:18<00:07,  1.93chunk/s]Loading shards:  91%|█████████ | 125/138 [01:18<00:05,  2.30chunk/s]Loading shards:  91%|█████████▏| 126/138 [01:19<00:04,  2.55chunk/s]Loading shards:  92%|█████████▏| 127/138 [01:19<00:04,  2.30chunk/s]Loading shards:  93%|█████████▎| 128/138 [01:20<00:04,  2.33chunk/s]Loading shards:  93%|█████████▎| 129/138 [01:20<00:03,  2.61chunk/s]Loading shards:  94%|█████████▍| 130/138 [01:20<00:02,  2.92chunk/s]Loading shards:  95%|█████████▍| 131/138 [01:20<00:02,  3.15chunk/s]Loading shards:  96%|█████████▌| 132/138 [01:21<00:01,  3.38chunk/s]Loading shards:  96%|█████████▋| 133/138 [01:21<00:01,  3.39chunk/s]Loading shards:  97%|█████████▋| 134/138 [01:21<00:01,  3.55chunk/s]Loading shards:  98%|█████████▊| 135/138 [01:21<00:00,  3.69chunk/s]Loading shards:  99%|█████████▊| 136/138 [01:22<00:00,  3.79chunk/s]Loading shards:  99%|█████████▉| 137/138 [01:22<00:00,  3.79chunk/s]Loading shards: 100%|██████████| 138/138 [01:22<00:00,  3.97chunk/s]Loading shards: 100%|██████████| 138/138 [01:22<00:00,  1.67chunk/s]
/var/spool/slurm/d/job201386/slurm_script: line 27: 3689197 Killed                  python cluster_chunks.py --chunks_root /vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/embeddings_v1_astrobert --work_dir ./cluster_out_v2_astrobert --backend umap_hdbscan --umap_dim 100 --n_neighbors 280 --min_cluster_size 10 --min_samples 5 --debug_memory
slurmstepd: error: Detected 1 oom_kill event in StepId=201386.batch. Some of the step tasks have been OOM Killed.
