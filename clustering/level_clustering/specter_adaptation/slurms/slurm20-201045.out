/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[GPU] GPU Available: True
[GPU] CUML Available: True
[scan] Using 138 shard folders
[load] Total paragraphs (after sampling): 1375099, dim=768
Load shards:   0%|          | 0/138 [00:00<?, ?chunk/s]Load shards:   1%|          | 1/138 [00:02<05:28,  2.40s/chunk]Load shards:   1%|▏         | 2/138 [00:03<03:33,  1.57s/chunk]Load shards:   2%|▏         | 3/138 [00:05<04:16,  1.90s/chunk]Load shards:   3%|▎         | 4/138 [00:07<04:14,  1.90s/chunk]Load shards:   4%|▎         | 5/138 [00:09<04:26,  2.00s/chunk]Load shards:   4%|▍         | 6/138 [00:11<04:08,  1.88s/chunk]Load shards:   5%|▌         | 7/138 [00:13<03:57,  1.82s/chunk]Load shards:   6%|▌         | 8/138 [00:14<03:49,  1.77s/chunk]Load shards:   7%|▋         | 9/138 [00:18<05:07,  2.39s/chunk]Load shards:   7%|▋         | 10/138 [00:22<06:15,  2.94s/chunk]Load shards:   8%|▊         | 11/138 [00:29<09:01,  4.26s/chunk]Load shards:   9%|▊         | 12/138 [00:37<10:58,  5.23s/chunk]Load shards:   9%|▉         | 13/138 [00:40<09:27,  4.54s/chunk]Load shards:  10%|█         | 14/138 [00:44<09:07,  4.42s/chunk]Load shards:  11%|█         | 15/138 [00:46<07:51,  3.83s/chunk]Load shards:  12%|█▏        | 16/138 [00:50<07:23,  3.63s/chunk]Load shards:  12%|█▏        | 17/138 [00:53<07:04,  3.51s/chunk]Load shards:  13%|█▎        | 18/138 [00:56<06:35,  3.30s/chunk]Load shards:  14%|█▍        | 19/138 [00:58<06:08,  3.09s/chunk]Load shards:  14%|█▍        | 20/138 [01:04<07:34,  3.85s/chunk]Load shards:  15%|█▌        | 21/138 [01:10<08:41,  4.45s/chunk]Load shards:  16%|█▌        | 22/138 [01:13<08:08,  4.21s/chunk]Load shards:  17%|█▋        | 23/138 [01:15<06:38,  3.46s/chunk]Load shards:  17%|█▋        | 24/138 [01:16<05:14,  2.76s/chunk]Load shards:  18%|█▊        | 25/138 [01:18<04:46,  2.54s/chunk]Load shards:  19%|█▉        | 26/138 [01:20<04:23,  2.35s/chunk]Load shards:  20%|█▉        | 27/138 [01:24<05:06,  2.76s/chunk]Load shards:  20%|██        | 28/138 [01:27<05:08,  2.81s/chunk]Load shards:  21%|██        | 29/138 [01:29<04:53,  2.70s/chunk]Load shards:  22%|██▏       | 30/138 [01:31<04:11,  2.33s/chunk]Load shards:  22%|██▏       | 31/138 [01:34<04:29,  2.52s/chunk]Load shards:  23%|██▎       | 32/138 [01:48<10:29,  5.94s/chunk]Load shards:  24%|██▍       | 33/138 [01:51<08:53,  5.08s/chunk]Load shards:  25%|██▍       | 34/138 [01:54<07:40,  4.43s/chunk]Load shards:  25%|██▌       | 35/138 [01:55<05:59,  3.49s/chunk]Load shards:  26%|██▌       | 36/138 [01:57<05:03,  2.97s/chunk]Load shards:  27%|██▋       | 37/138 [01:59<04:30,  2.68s/chunk]Load shards:  28%|██▊       | 38/138 [02:00<03:55,  2.36s/chunk]Load shards:  28%|██▊       | 39/138 [02:08<06:20,  3.85s/chunk]Load shards:  29%|██▉       | 40/138 [02:10<05:45,  3.52s/chunk]Load shards:  30%|██▉       | 41/138 [02:12<04:44,  2.93s/chunk]Load shards:  30%|███       | 42/138 [02:15<04:46,  2.98s/chunk]Load shards:  31%|███       | 43/138 [02:18<04:39,  2.94s/chunk]Load shards:  32%|███▏      | 44/138 [02:20<04:23,  2.81s/chunk]Load shards:  33%|███▎      | 45/138 [02:22<03:55,  2.54s/chunk]Load shards:  33%|███▎      | 46/138 [02:25<03:58,  2.59s/chunk]Load shards:  34%|███▍      | 47/138 [02:31<05:21,  3.54s/chunk]Load shards:  35%|███▍      | 48/138 [02:32<04:30,  3.00s/chunk]Load shards:  36%|███▌      | 49/138 [02:34<03:43,  2.51s/chunk]Load shards:  36%|███▌      | 50/138 [02:35<03:07,  2.13s/chunk]Load shards:  37%|███▋      | 51/138 [02:37<02:54,  2.01s/chunk]Load shards:  38%|███▊      | 52/138 [02:37<02:19,  1.63s/chunk]Load shards:  38%|███▊      | 53/138 [02:40<02:28,  1.75s/chunk]Load shards:  39%|███▉      | 54/138 [02:40<02:01,  1.45s/chunk]Load shards:  40%|███▉      | 55/138 [02:42<02:07,  1.53s/chunk]Load shards:  41%|████      | 56/138 [02:43<01:56,  1.42s/chunk]Load shards:  41%|████▏     | 57/138 [02:45<02:06,  1.56s/chunk]Load shards:  42%|████▏     | 58/138 [02:47<02:24,  1.80s/chunk]Load shards:  43%|████▎     | 59/138 [02:50<02:35,  1.97s/chunk]Load shards:  43%|████▎     | 60/138 [02:52<02:28,  1.91s/chunk]Load shards:  44%|████▍     | 61/138 [02:54<02:48,  2.18s/chunk]Load shards:  45%|████▍     | 62/138 [02:55<02:11,  1.73s/chunk]Load shards:  46%|████▌     | 63/138 [03:00<03:16,  2.62s/chunk]Load shards:  46%|████▋     | 64/138 [03:03<03:21,  2.73s/chunk]Load shards:  47%|████▋     | 65/138 [03:05<03:17,  2.71s/chunk]Load shards:  48%|████▊     | 66/138 [03:06<02:33,  2.13s/chunk]Load shards:  49%|████▊     | 67/138 [03:10<03:00,  2.54s/chunk]Load shards:  49%|████▉     | 68/138 [03:11<02:32,  2.18s/chunk]Load shards:  50%|█████     | 69/138 [03:14<02:39,  2.31s/chunk]Load shards:  51%|█████     | 70/138 [03:17<02:57,  2.61s/chunk]Load shards:  51%|█████▏    | 71/138 [03:20<02:55,  2.62s/chunk]Load shards:  52%|█████▏    | 72/138 [03:23<03:03,  2.79s/chunk]Load shards:  53%|█████▎    | 73/138 [03:26<03:14,  2.99s/chunk]Load shards:  54%|█████▎    | 74/138 [03:29<03:13,  3.02s/chunk]Load shards:  54%|█████▍    | 75/138 [03:32<02:54,  2.77s/chunk]Load shards:  55%|█████▌    | 76/138 [03:35<03:01,  2.92s/chunk]Load shards:  56%|█████▌    | 77/138 [03:37<02:38,  2.60s/chunk]Load shards:  57%|█████▋    | 78/138 [03:37<02:04,  2.08s/chunk]Load shards:  57%|█████▋    | 79/138 [03:39<02:01,  2.06s/chunk]Load shards:  58%|█████▊    | 80/138 [03:41<01:55,  1.99s/chunk]Load shards:  59%|█████▊    | 81/138 [03:44<02:08,  2.26s/chunk]Load shards:  59%|█████▉    | 82/138 [03:47<02:18,  2.47s/chunk]Load shards:  60%|██████    | 83/138 [03:48<01:48,  1.97s/chunk]Load shards:  61%|██████    | 84/138 [03:49<01:30,  1.68s/chunk]Load shards:  62%|██████▏   | 85/138 [03:51<01:40,  1.90s/chunk]Load shards:  62%|██████▏   | 86/138 [03:52<01:25,  1.64s/chunk]Load shards:  63%|██████▎   | 87/138 [03:54<01:24,  1.65s/chunk]Load shards:  64%|██████▍   | 88/138 [03:55<01:14,  1.50s/chunk]Load shards:  64%|██████▍   | 89/138 [03:56<01:00,  1.23s/chunk]Load shards:  65%|██████▌   | 90/138 [03:57<00:56,  1.18s/chunk]Load shards:  66%|██████▌   | 91/138 [03:58<00:55,  1.18s/chunk]Load shards:  67%|██████▋   | 92/138 [04:00<00:57,  1.25s/chunk]Load shards:  67%|██████▋   | 93/138 [04:01<01:02,  1.39s/chunk]Load shards:  68%|██████▊   | 94/138 [04:03<01:05,  1.48s/chunk]Load shards:  69%|██████▉   | 95/138 [04:04<00:55,  1.29s/chunk]Load shards:  70%|██████▉   | 96/138 [04:05<00:54,  1.30s/chunk]Load shards:  70%|███████   | 97/138 [04:06<00:53,  1.31s/chunk]Load shards:  71%|███████   | 98/138 [04:07<00:49,  1.23s/chunk]Load shards:  72%|███████▏  | 99/138 [04:08<00:42,  1.10s/chunk]Load shards:  72%|███████▏  | 100/138 [04:09<00:40,  1.08s/chunk]Load shards:  73%|███████▎  | 101/138 [04:11<00:43,  1.18s/chunk]Load shards:  74%|███████▍  | 102/138 [04:12<00:42,  1.18s/chunk]Load shards:  75%|███████▍  | 103/138 [04:13<00:42,  1.23s/chunk]Load shards:  75%|███████▌  | 104/138 [04:14<00:39,  1.17s/chunk]Load shards:  76%|███████▌  | 105/138 [04:15<00:37,  1.15s/chunk]Load shards:  77%|███████▋  | 106/138 [04:16<00:35,  1.12s/chunk]Load shards:  78%|███████▊  | 107/138 [04:17<00:33,  1.08s/chunk]Load shards:  78%|███████▊  | 108/138 [04:18<00:30,  1.02s/chunk]Load shards:  79%|███████▉  | 109/138 [04:19<00:29,  1.03s/chunk]Load shards:  80%|███████▉  | 110/138 [04:20<00:27,  1.02chunk/s]Load shards:  80%|████████  | 111/138 [04:21<00:25,  1.08chunk/s]Load shards:  81%|████████  | 112/138 [04:22<00:24,  1.04chunk/s]Load shards:  82%|████████▏ | 113/138 [04:23<00:23,  1.06chunk/s]Load shards:  83%|████████▎ | 114/138 [04:24<00:22,  1.05chunk/s]Load shards:  83%|████████▎ | 115/138 [04:25<00:21,  1.09chunk/s]Load shards:  84%|████████▍ | 116/138 [04:26<00:20,  1.09chunk/s]Load shards:  85%|████████▍ | 117/138 [04:27<00:20,  1.02chunk/s]Load shards:  86%|████████▌ | 118/138 [04:28<00:22,  1.10s/chunk]Load shards:  86%|████████▌ | 119/138 [04:29<00:21,  1.14s/chunk]Load shards:  87%|████████▋ | 120/138 [04:31<00:22,  1.23s/chunk]Load shards:  88%|████████▊ | 121/138 [04:32<00:18,  1.07s/chunk]Load shards:  88%|████████▊ | 122/138 [04:33<00:17,  1.10s/chunk]Load shards:  89%|████████▉ | 123/138 [04:34<00:15,  1.04s/chunk]Load shards:  90%|████████▉ | 124/138 [04:35<00:14,  1.00s/chunk]Load shards:  91%|█████████ | 125/138 [04:36<00:13,  1.05s/chunk]Load shards:  91%|█████████▏| 126/138 [04:37<00:12,  1.01s/chunk]Load shards:  92%|█████████▏| 127/138 [04:38<00:11,  1.00s/chunk]Load shards:  93%|█████████▎| 128/138 [04:39<00:10,  1.01s/chunk]Load shards:  93%|█████████▎| 129/138 [04:40<00:10,  1.13s/chunk]Load shards:  94%|█████████▍| 130/138 [04:41<00:09,  1.21s/chunk]Load shards:  95%|█████████▍| 131/138 [04:43<00:09,  1.36s/chunk]Load shards:  96%|█████████▌| 132/138 [04:47<00:12,  2.11s/chunk]Load shards:  96%|█████████▋| 133/138 [04:48<00:09,  1.83s/chunk]Load shards:  97%|█████████▋| 134/138 [04:49<00:06,  1.58s/chunk]Load shards:  98%|█████████▊| 135/138 [04:51<00:04,  1.59s/chunk]Load shards:  99%|█████████▊| 136/138 [04:52<00:02,  1.35s/chunk]Load shards:  99%|█████████▉| 137/138 [04:53<00:01,  1.29s/chunk]Load shards: 100%|██████████| 138/138 [04:53<00:00,  1.12s/chunk]Load shards: 100%|██████████| 138/138 [04:53<00:00,  2.13s/chunk]
/var/spool/slurm/d/job201045/slurm_script: line 26: 1928956 Killed                  python cluster_chunks.py --chunks_root /vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/embeddings_v1_astrobert --work_dir ./cluster_out_v2_astrobert --backend umap_hdbscan --umap_dim 60 --n_neighbors 240 --min_cluster_size 12 --min_samples 2
slurmstepd: error: Detected 1 oom_kill event in StepId=201045.batch. Some of the step tasks have been OOM Killed.
