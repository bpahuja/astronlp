/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[GPU] GPU Available: True
[GPU] CUML Available: True
[scan] Using 138 shard folders
[load] Total paragraphs (after sampling): 1375099, dim=768
Load shards:   0%|          | 0/138 [00:00<?, ?chunk/s]Load shards:   1%|          | 1/138 [00:00<00:16,  8.08chunk/s]Load shards:   1%|▏         | 2/138 [00:00<00:16,  8.09chunk/s]Load shards:   2%|▏         | 3/138 [00:00<00:16,  8.04chunk/s]Load shards:   3%|▎         | 4/138 [00:00<00:16,  8.05chunk/s]Load shards:   4%|▎         | 5/138 [00:00<00:16,  8.02chunk/s]Load shards:   4%|▍         | 6/138 [00:00<00:16,  7.98chunk/s]Load shards:   5%|▌         | 7/138 [00:01<00:50,  2.61chunk/s]Load shards:   6%|▌         | 8/138 [00:02<01:07,  1.94chunk/s]Load shards:   7%|▋         | 9/138 [00:03<01:30,  1.42chunk/s]Load shards:   7%|▋         | 10/138 [00:04<01:41,  1.26chunk/s]Load shards:   8%|▊         | 11/138 [00:05<01:55,  1.10chunk/s]Load shards:   9%|▊         | 12/138 [00:06<01:54,  1.10chunk/s]Load shards:   9%|▉         | 13/138 [00:07<01:44,  1.19chunk/s]Load shards:  10%|█         | 14/138 [00:08<01:48,  1.15chunk/s]Load shards:  11%|█         | 15/138 [00:09<01:53,  1.08chunk/s]Load shards:  12%|█▏        | 16/138 [00:09<01:43,  1.18chunk/s]Load shards:  12%|█▏        | 17/138 [00:11<02:01,  1.00s/chunk]Load shards:  13%|█▎        | 18/138 [00:12<02:01,  1.01s/chunk]Load shards:  14%|█▍        | 19/138 [00:13<01:54,  1.04chunk/s]Load shards:  14%|█▍        | 20/138 [00:14<01:57,  1.01chunk/s]Load shards:  15%|█▌        | 21/138 [00:15<02:05,  1.07s/chunk]Load shards:  16%|█▌        | 22/138 [00:16<01:49,  1.06chunk/s]Load shards:  17%|█▋        | 23/138 [00:16<01:37,  1.18chunk/s]Load shards:  17%|█▋        | 24/138 [00:17<01:22,  1.39chunk/s]Load shards:  18%|█▊        | 25/138 [00:18<01:29,  1.26chunk/s]Load shards:  19%|█▉        | 26/138 [00:18<01:22,  1.36chunk/s]Load shards:  20%|█▉        | 27/138 [00:19<01:36,  1.15chunk/s]Load shards:  20%|██        | 28/138 [00:21<01:59,  1.09s/chunk]Load shards:  21%|██        | 29/138 [00:23<02:36,  1.44s/chunk]Load shards:  22%|██▏       | 30/138 [00:24<02:23,  1.33s/chunk]Load shards:  22%|██▏       | 31/138 [00:25<02:06,  1.19s/chunk]Load shards:  23%|██▎       | 32/138 [00:26<02:00,  1.14s/chunk]Load shards:  24%|██▍       | 33/138 [00:27<01:57,  1.12s/chunk]Load shards:  25%|██▍       | 34/138 [00:28<01:52,  1.08s/chunk]Load shards:  25%|██▌       | 35/138 [00:29<01:37,  1.06chunk/s]Load shards:  26%|██▌       | 36/138 [00:30<01:30,  1.13chunk/s]Load shards:  27%|██▋       | 37/138 [00:31<01:27,  1.16chunk/s]Load shards:  28%|██▊       | 38/138 [00:31<01:20,  1.24chunk/s]Load shards:  28%|██▊       | 39/138 [00:33<01:37,  1.02chunk/s]Load shards:  29%|██▉       | 40/138 [00:35<02:22,  1.46s/chunk]Load shards:  30%|██▉       | 41/138 [00:36<02:12,  1.37s/chunk]Load shards:  30%|███       | 42/138 [00:39<02:56,  1.84s/chunk]Load shards:  31%|███       | 43/138 [00:44<04:26,  2.81s/chunk]Load shards:  32%|███▏      | 44/138 [00:46<04:02,  2.58s/chunk]Load shards:  33%|███▎      | 45/138 [00:48<03:22,  2.18s/chunk]Load shards:  33%|███▎      | 46/138 [00:49<02:55,  1.91s/chunk]Load shards:  34%|███▍      | 47/138 [00:50<02:18,  1.53s/chunk]Load shards:  35%|███▍      | 48/138 [00:50<02:01,  1.35s/chunk]Load shards:  36%|███▌      | 49/138 [00:52<02:00,  1.35s/chunk]Load shards:  36%|███▌      | 50/138 [00:53<02:07,  1.45s/chunk]Load shards:  37%|███▋      | 51/138 [00:55<02:03,  1.42s/chunk]Load shards:  38%|███▊      | 52/138 [00:56<02:02,  1.43s/chunk]Load shards:  38%|███▊      | 53/138 [00:58<01:58,  1.39s/chunk]Load shards:  39%|███▉      | 54/138 [00:59<01:51,  1.33s/chunk]Load shards:  40%|███▉      | 55/138 [01:00<01:41,  1.22s/chunk]Load shards:  41%|████      | 56/138 [01:00<01:26,  1.06s/chunk]Load shards:  41%|████▏     | 57/138 [01:02<01:27,  1.08s/chunk]Load shards:  42%|████▏     | 58/138 [01:02<01:22,  1.03s/chunk]Load shards:  43%|████▎     | 59/138 [01:03<01:20,  1.02s/chunk]Load shards:  43%|████▎     | 60/138 [01:04<01:15,  1.04chunk/s]Load shards:  44%|████▍     | 61/138 [01:05<01:13,  1.04chunk/s]Load shards:  45%|████▍     | 62/138 [01:06<01:17,  1.02s/chunk]Load shards:  46%|████▌     | 63/138 [01:07<01:17,  1.03s/chunk]Load shards:  46%|████▋     | 64/138 [01:08<01:13,  1.01chunk/s]Load shards:  47%|████▋     | 65/138 [01:10<01:24,  1.16s/chunk]Load shards:  48%|████▊     | 66/138 [01:11<01:25,  1.19s/chunk]Load shards:  49%|████▊     | 67/138 [01:13<01:45,  1.48s/chunk]Load shards:  49%|████▉     | 68/138 [01:14<01:33,  1.34s/chunk]Load shards:  50%|█████     | 69/138 [01:16<01:29,  1.29s/chunk]Load shards:  51%|█████     | 70/138 [01:17<01:32,  1.36s/chunk]Load shards:  51%|█████▏    | 71/138 [01:18<01:20,  1.20s/chunk]Load shards:  52%|█████▏    | 72/138 [01:19<01:23,  1.26s/chunk]Load shards:  53%|█████▎    | 73/138 [01:22<01:40,  1.54s/chunk]Load shards:  54%|█████▎    | 74/138 [01:24<01:52,  1.76s/chunk]Load shards:  54%|█████▍    | 75/138 [01:25<01:41,  1.61s/chunk]Load shards:  55%|█████▌    | 76/138 [01:27<01:41,  1.63s/chunk]Load shards:  56%|█████▌    | 77/138 [01:27<01:21,  1.33s/chunk]Load shards:  57%|█████▋    | 78/138 [01:30<01:41,  1.69s/chunk]Load shards:  57%|█████▋    | 79/138 [01:31<01:34,  1.59s/chunk]Load shards:  58%|█████▊    | 80/138 [01:32<01:18,  1.35s/chunk]Load shards:  59%|█████▊    | 81/138 [01:34<01:24,  1.47s/chunk]Load shards:  59%|█████▉    | 82/138 [01:36<01:36,  1.73s/chunk]Load shards:  60%|██████    | 83/138 [01:39<01:46,  1.93s/chunk]Load shards:  61%|██████    | 84/138 [01:42<02:14,  2.49s/chunk]Load shards:  62%|██████▏   | 85/138 [01:44<01:53,  2.14s/chunk]Load shards:  62%|██████▏   | 86/138 [01:52<03:26,  3.97s/chunk]Load shards:  63%|██████▎   | 87/138 [01:57<03:37,  4.26s/chunk]Load shards:  64%|██████▍   | 88/138 [01:58<02:40,  3.21s/chunk]Load shards:  64%|██████▍   | 89/138 [01:58<02:01,  2.48s/chunk]Load shards:  65%|██████▌   | 90/138 [02:02<02:12,  2.76s/chunk]Load shards:  66%|██████▌   | 91/138 [02:03<01:54,  2.44s/chunk]Load shards:  67%|██████▋   | 92/138 [02:05<01:40,  2.18s/chunk]Load shards:  67%|██████▋   | 93/138 [02:07<01:31,  2.04s/chunk]Load shards:  68%|██████▊   | 94/138 [02:09<01:30,  2.06s/chunk]Load shards:  69%|██████▉   | 95/138 [02:10<01:16,  1.79s/chunk]Load shards:  70%|██████▉   | 96/138 [02:11<01:11,  1.70s/chunk]Load shards:  70%|███████   | 97/138 [02:13<01:10,  1.72s/chunk]Load shards:  71%|███████   | 98/138 [02:14<01:01,  1.55s/chunk]Load shards:  72%|███████▏  | 99/138 [02:16<01:01,  1.58s/chunk]Load shards:  72%|███████▏  | 100/138 [02:17<00:54,  1.43s/chunk]Load shards:  73%|███████▎  | 101/138 [02:18<00:49,  1.33s/chunk]Load shards:  74%|███████▍  | 102/138 [02:19<00:45,  1.28s/chunk]Load shards:  75%|███████▍  | 103/138 [02:21<00:46,  1.33s/chunk]Load shards:  75%|███████▌  | 104/138 [02:22<00:38,  1.14s/chunk]Load shards:  76%|███████▌  | 105/138 [02:23<00:36,  1.10s/chunk]Load shards:  77%|███████▋  | 106/138 [02:24<00:35,  1.10s/chunk]Load shards:  78%|███████▊  | 107/138 [02:25<00:33,  1.07s/chunk]Load shards:  78%|███████▊  | 108/138 [02:26<00:30,  1.02s/chunk]Load shards:  79%|███████▉  | 109/138 [02:27<00:35,  1.22s/chunk]Load shards:  80%|███████▉  | 110/138 [02:28<00:30,  1.07s/chunk]Load shards:  80%|████████  | 111/138 [02:30<00:33,  1.24s/chunk]Load shards:  81%|████████  | 112/138 [02:31<00:32,  1.24s/chunk]Load shards:  82%|████████▏ | 113/138 [02:32<00:32,  1.29s/chunk]Load shards:  83%|████████▎ | 114/138 [02:34<00:31,  1.32s/chunk]Load shards:  83%|████████▎ | 115/138 [02:36<00:35,  1.54s/chunk]Load shards:  84%|████████▍ | 116/138 [02:37<00:33,  1.51s/chunk]Load shards:  85%|████████▍ | 117/138 [02:38<00:29,  1.38s/chunk]Load shards:  86%|████████▌ | 118/138 [02:39<00:23,  1.20s/chunk]Load shards:  86%|████████▌ | 119/138 [02:40<00:22,  1.19s/chunk]Load shards:  87%|████████▋ | 120/138 [02:43<00:29,  1.66s/chunk]Load shards:  88%|████████▊ | 121/138 [02:53<01:12,  4.24s/chunk]Load shards:  88%|████████▊ | 122/138 [02:54<00:52,  3.28s/chunk]Load shards:  89%|████████▉ | 123/138 [02:55<00:38,  2.58s/chunk]Load shards:  90%|████████▉ | 124/138 [02:57<00:31,  2.27s/chunk]Load shards:  91%|█████████ | 125/138 [02:58<00:26,  2.02s/chunk]Load shards:  91%|█████████▏| 126/138 [03:00<00:22,  1.88s/chunk]Load shards:  92%|█████████▏| 127/138 [03:01<00:19,  1.77s/chunk]Load shards:  93%|█████████▎| 128/138 [03:02<00:14,  1.49s/chunk]Load shards:  93%|█████████▎| 129/138 [03:04<00:13,  1.54s/chunk]Load shards:  94%|█████████▍| 130/138 [03:05<00:11,  1.46s/chunk]Load shards:  95%|█████████▍| 131/138 [03:16<00:30,  4.34s/chunk]Load shards:  96%|█████████▌| 132/138 [03:19<00:23,  3.88s/chunk]Load shards:  96%|█████████▋| 133/138 [03:20<00:15,  3.18s/chunk]Load shards:  97%|█████████▋| 134/138 [03:22<00:10,  2.57s/chunk]Load shards:  98%|█████████▊| 135/138 [03:23<00:06,  2.29s/chunk]Load shards:  99%|█████████▊| 136/138 [03:24<00:03,  1.90s/chunk]Load shards:  99%|█████████▉| 137/138 [03:25<00:01,  1.72s/chunk]Load shards: 100%|██████████| 138/138 [03:27<00:00,  1.62s/chunk]Load shards: 100%|██████████| 138/138 [03:27<00:00,  1.50s/chunk]
/var/spool/slurm/d/job201055/slurm_script: line 26: 371106 Killed                  python cluster_chunks.py --chunks_root /vol/bitbucket/bp824/astro/level_clustering/specter_adaptation/embeddings_v1_astrobert --work_dir ./cluster_out_v2_astrobert --backend umap_hdbscan --umap_dim 60 --n_neighbors 240 --min_cluster_size 12 --min_samples 2 --debug_memory
slurmstepd: error: Detected 1 oom_kill event in StepId=201055.batch. Some of the step tasks have been OOM Killed.
