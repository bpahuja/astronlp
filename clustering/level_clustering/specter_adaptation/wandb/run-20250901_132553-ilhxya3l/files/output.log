100%|██████████| 1602/1602 [39:50<00:00,  1.49s/it]
{'loss': 4.2845, 'grad_norm': 0.8654281497001648, 'learning_rate': 7.247043363994744e-05, 'epoch': 1.87}
{'loss': 3.9616, 'grad_norm': 1.223497748374939, 'learning_rate': 3.961892247043364e-05, 'epoch': 3.75}
{'loss': 3.8851, 'grad_norm': 1.5785975456237793, 'learning_rate': 6.767411300919843e-06, 'epoch': 5.62}
{'train_runtime': 2400.2156, 'train_samples_per_second': 85.432, 'train_steps_per_second': 0.667, 'train_loss': 4.031735480947887, 'epoch': 6.0}
Batches: 100%|██████████| 10/10 [00:01<00:00,  6.73it/s]
Batches: 100%|██████████| 10/10 [00:01<00:00,  8.03it/s]
Batches: 100%|██████████| 10/10 [00:01<00:00,  7.87it/s]
[eval] allenai_specter2_base: pos=0.9571 rand=0.7730 gap=0.1841
[cluster] running paragraph clustering eval...
/vol/bitbucket/bp824/astro/astroenv/lib/python3.12/site-packages/umap/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Encode (hierarchical): 100%|██████████| 808/808 [00:17<00:00, 45.06it/s]
[cluster] noise=0.2% clusters=4 paragraphs=808
There are adapters available but none are activated for the forward pass.
[train] base=adsabs/astroBERT adapter=pfeiffer r=12 lr=0.0001 epochs=6 mask_prob=0.5
[warn] gradient_accumulation_steps not supported by your sentence-transformers version. Falling back to no accumulation (increase --batch_size or upgrade ST).
100%|██████████| 1602/1602 [40:46<00:00,  1.53s/it]                  
{'loss': 4.1861, 'grad_norm': 1.5841941833496094, 'learning_rate': 7.260183968462549e-05, 'epoch': 1.87}
{'loss': 3.8416, 'grad_norm': 1.5164539813995361, 'learning_rate': 3.97503285151117e-05, 'epoch': 3.75}
{'loss': 3.7757, 'grad_norm': 1.4522181749343872, 'learning_rate': 6.898817345597898e-06, 'epoch': 5.62}
{'train_runtime': 2446.6339, 'train_samples_per_second': 83.811, 'train_steps_per_second': 0.655, 'train_loss': 3.9233402056938105, 'epoch': 6.0}
Batches: 100%|██████████| 10/10 [00:01<00:00,  7.40it/s]
Batches: 100%|██████████| 10/10 [00:01<00:00,  7.65it/s]
Batches: 100%|██████████| 10/10 [00:01<00:00,  7.68it/s]
[eval] adsabs_astroBERT: pos=0.9622 rand=0.7672 gap=0.1950
[cluster] running paragraph clustering eval...
Encode (hierarchical): 100%|██████████| 808/808 [00:17<00:00, 47.48it/s]
[cluster] noise=22.4% clusters=20 paragraphs=808

=== Bake-off summary ===
                 base  pos_mean  rand_mean      gap  cluster_noise_pct  cluster_n_clusters  cluster_paragraphs
allenai/specter2_base  0.957083   0.772957 0.184127           0.247525                   4                 808
     adsabs/astroBERT  0.962221   0.767237 0.194985          22.400990                  20                 808

Winner: adsabs/astroBERT (gap=0.1950)
